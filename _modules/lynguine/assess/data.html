

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lynguine.assess.data &mdash; referia 0.2 Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=938c9ccc"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            referia
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction to Referia</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction.html#what-is-referia">What is Referia?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction.html#relationship-with-lynguine">Relationship with Lynguine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction.html#key-features">Key Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction.html#documentation-organization">Documentation Organization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#installation-from-source">Installation from Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#installation-with-pip">Installation with pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#development-installation">Development Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#verifying-the-installation">Verifying the Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#dependencies">Dependencies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#understanding-the-inheritance-structure">Understanding the Inheritance Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#review-configuration">Review Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#working-with-compute-functions">Working with Compute Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/assess.html">Assess Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/assess.html#compute-class">Compute Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute"><code class="docutils literal notranslate"><span class="pre">Compute</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.prep_all"><code class="docutils literal notranslate"><span class="pre">Compute.prep_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.copy_screen_capture"><code class="docutils literal notranslate"><span class="pre">Compute.copy_screen_capture()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.preprocess"><code class="docutils literal notranslate"><span class="pre">Compute.preprocess()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.run_onchange"><code class="docutils literal notranslate"><span class="pre">Compute.run_onchange()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.add_liquid_filters"><code class="docutils literal notranslate"><span class="pre">Compute.add_liquid_filters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.computes"><code class="docutils literal notranslate"><span class="pre">Compute.computes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.filter"><code class="docutils literal notranslate"><span class="pre">Compute.filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.from_flow"><code class="docutils literal notranslate"><span class="pre">Compute.from_flow()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.gca_"><code class="docutils literal notranslate"><span class="pre">Compute.gca_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.gcf_"><code class="docutils literal notranslate"><span class="pre">Compute.gcf_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.load_liquid"><code class="docutils literal notranslate"><span class="pre">Compute.load_liquid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.postcomputes"><code class="docutils literal notranslate"><span class="pre">Compute.postcomputes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.precomputes"><code class="docutils literal notranslate"><span class="pre">Compute.precomputes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.prep"><code class="docutils literal notranslate"><span class="pre">Compute.prep()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.run"><code class="docutils literal notranslate"><span class="pre">Compute.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.run_all"><code class="docutils literal notranslate"><span class="pre">Compute.run_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.compute.Compute.setup_logger"><code class="docutils literal notranslate"><span class="pre">Compute.setup_logger()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/assess.html#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/assess.html#function-registry">Function Registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/assess.html#usage-example">Usage Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/assess.html#data-classes">Data Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.augment"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.augment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.sort_series"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.sort_series()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.set_index"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.set_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.check_or_set_subseries"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.check_or_set_subseries()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_index"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.preprocess"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.preprocess()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.compute_pre"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.compute_pre()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.compute_post"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.compute_post()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_subindex"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_subindex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.reset_subindex"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.reset_subindex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.generate_subindex"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.generate_subindex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.set_series_value"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.set_series_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.drop_column"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.drop_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.filter_rows"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.filter_rows()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_shape"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_shape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_value_by_element"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_value_by_element()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.set_value_by_element"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.set_value_by_element()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_column_values"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_column_values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_value"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.add_column"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.add_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.set_dtype"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.set_dtype()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.add_series_row"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.add_series_row()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.add_series_column"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.add_series_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.T"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.add"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.add()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.add_row"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.add_row()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.apply"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.augment_with_df"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.augment_with_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.autocache"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.autocache</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.colspecs"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.colspecs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.coltype"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.coltype()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.columns"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.columns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.compute"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.compute</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.compute_to_tmpname"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.compute_to_tmpname()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.compute_to_value"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.compute_to_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.conditions"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.conditions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.convert"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.convert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.describe"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.describe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.display_to_tmpname"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.display_to_tmpname()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.display_to_value"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.display_to_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.dot"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.dot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.drop_duplicates"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.drop_duplicates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.dropna"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.dropna()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.dtypes"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.dtypes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.empty"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.empty</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.equals"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.equals()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.fillna"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.fillna()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.filter"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.from_csv"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.from_csv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.from_dict"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.from_flow"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.from_flow()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.from_pandas"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.from_pandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_column"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_column_type"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_column_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_input_columns"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_input_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_output_columns"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_output_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_parameters_columns"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_parameters_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_selector"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_selector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_selectors"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_selectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_series_columns"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_series_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_subindices"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_subindices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_subseries"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_subseries()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_subseries_values"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_subseries_values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_type_columns"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_type_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_value_column"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.get_value_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.groupby"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.groupby()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.head"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.head()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.index"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.index</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.interface"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.interface</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.ismutable"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.ismutable()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.isna"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.isna()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.isnull"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.isnull()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.isparameter"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.isparameter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.isseries"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.isseries()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.join"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.join()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.liquid_to_tmpname"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.liquid_to_tmpname()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.liquid_to_value"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.liquid_to_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.log"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.log</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.mapping"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.mapping()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.mean"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.merge"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.multiply"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.multiply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.mutable"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.mutable</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.notna"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.notna()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.pivot_table"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.pivot_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.save_flows"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.save_flows()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.set_column"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.set_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.set_selector"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.set_selector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.set_subindex"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.set_subindex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.set_value"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.set_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.set_value_column"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.set_value_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.shape"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.sort_index"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.sort_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.sort_values"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.sort_values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.subtract"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.subtract()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.sum"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.sum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.summary_view_to_value"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.summary_view_to_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.summary_viewer_to_value"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.summary_viewer_to_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.tail"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.tail()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.tally_series"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.tally_series()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.tally_to_tmpname"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.tally_to_tmpname()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.tally_to_value"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.tally_to_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.tally_values"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.tally_values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_clipboard"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_clipboard()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_csv"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_csv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_dict"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_excel"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_excel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_feather"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_feather()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_flow"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_flow()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_gbq"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_gbq()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_hdf"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_hdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_html"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_html()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_json"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_latex"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_latex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_markdown"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_numpy"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_numpy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_orc"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_orc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_pandas"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_pandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_parquet"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_parquet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_period"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_period()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_records"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_records()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_sql"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_sql()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_stata"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_stata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_string"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_string()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_timestamp"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_timestamp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_xarray"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_xarray()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_xml"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_xml()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.transpose"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.transpose()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.types"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.update_from_pandas"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.update_from_pandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.update_name_column_map"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.update_name_column_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.valid_data_types"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.valid_data_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.values"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.values</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.view_to_tmpname"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.view_to_tmpname()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.view_to_value"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.view_to_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.viewer_to_value"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.viewer_to_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_score"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.to_score()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.scored"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.scored()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.compute_from_flow"><code class="docutils literal notranslate"><span class="pre">CustomDataFrame.compute_from_flow()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/assess.html#review-classes">Review Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer"><code class="docutils literal notranslate"><span class="pre">Reviewer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.set_default_field_value"><code class="docutils literal notranslate"><span class="pre">Reviewer.set_default_field_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.set_default_field_source"><code class="docutils literal notranslate"><span class="pre">Reviewer.set_default_field_source()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.add_views"><code class="docutils literal notranslate"><span class="pre">Reviewer.add_views()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.add_dynamic"><code class="docutils literal notranslate"><span class="pre">Reviewer.add_dynamic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.get_selectors"><code class="docutils literal notranslate"><span class="pre">Reviewer.get_selectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.get_selector"><code class="docutils literal notranslate"><span class="pre">Reviewer.get_selector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.set_selector"><code class="docutils literal notranslate"><span class="pre">Reviewer.set_selector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.get_indices"><code class="docutils literal notranslate"><span class="pre">Reviewer.get_indices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.get_subindices"><code class="docutils literal notranslate"><span class="pre">Reviewer.get_subindices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.get_subindex"><code class="docutils literal notranslate"><span class="pre">Reviewer.get_subindex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.set_subindex"><code class="docutils literal notranslate"><span class="pre">Reviewer.set_subindex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.add_row"><code class="docutils literal notranslate"><span class="pre">Reviewer.add_row()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.add_series_row"><code class="docutils literal notranslate"><span class="pre">Reviewer.add_series_row()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.full_selector"><code class="docutils literal notranslate"><span class="pre">Reviewer.full_selector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.select_index"><code class="docutils literal notranslate"><span class="pre">Reviewer.select_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.select_selector"><code class="docutils literal notranslate"><span class="pre">Reviewer.select_selector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.select_subindex"><code class="docutils literal notranslate"><span class="pre">Reviewer.select_subindex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.get_select_selector"><code class="docutils literal notranslate"><span class="pre">Reviewer.get_select_selector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.set_select_selector"><code class="docutils literal notranslate"><span class="pre">Reviewer.set_select_selector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.get_select_subindex"><code class="docutils literal notranslate"><span class="pre">Reviewer.get_select_subindex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.set_select_subindex"><code class="docutils literal notranslate"><span class="pre">Reviewer.set_select_subindex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.get_most_recent_screen_capture"><code class="docutils literal notranslate"><span class="pre">Reviewer.get_most_recent_screen_capture()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.run"><code class="docutils literal notranslate"><span class="pre">Reviewer.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.template_to_value"><code class="docutils literal notranslate"><span class="pre">Reviewer.template_to_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.load_flows"><code class="docutils literal notranslate"><span class="pre">Reviewer.load_flows()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.create_document"><code class="docutils literal notranslate"><span class="pre">Reviewer.create_document()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.create_summary"><code class="docutils literal notranslate"><span class="pre">Reviewer.create_summary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.compute"><code class="docutils literal notranslate"><span class="pre">Reviewer.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.compute_onchange"><code class="docutils literal notranslate"><span class="pre">Reviewer.compute_onchange()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.value_updated"><code class="docutils literal notranslate"><span class="pre">Reviewer.value_updated()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.populate_display"><code class="docutils literal notranslate"><span class="pre">Reviewer.populate_display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.add_downstream_display"><code class="docutils literal notranslate"><span class="pre">Reviewer.add_downstream_display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.get_column"><code class="docutils literal notranslate"><span class="pre">Reviewer.get_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.get_index"><code class="docutils literal notranslate"><span class="pre">Reviewer.get_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.get_value"><code class="docutils literal notranslate"><span class="pre">Reviewer.get_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.get_value_by_element"><code class="docutils literal notranslate"><span class="pre">Reviewer.get_value_by_element()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.index"><code class="docutils literal notranslate"><span class="pre">Reviewer.index</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.load_input_flows"><code class="docutils literal notranslate"><span class="pre">Reviewer.load_input_flows()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.load_output_flows"><code class="docutils literal notranslate"><span class="pre">Reviewer.load_output_flows()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.save_flows"><code class="docutils literal notranslate"><span class="pre">Reviewer.save_flows()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.set_column"><code class="docutils literal notranslate"><span class="pre">Reviewer.set_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.set_index"><code class="docutils literal notranslate"><span class="pre">Reviewer.set_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.set_value"><code class="docutils literal notranslate"><span class="pre">Reviewer.set_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.set_value_by_element"><code class="docutils literal notranslate"><span class="pre">Reviewer.set_value_by_element()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/assess.html#referia.assess.review.Reviewer.view_series"><code class="docutils literal notranslate"><span class="pre">Reviewer.view_series()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/assess.html#id1">Key Features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/assess.html#inheritance-diagram">Inheritance Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/assess.html#module-functions">Module Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/config.html">Configuration Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/config.html#interface">Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface"><code class="docutils literal notranslate"><span class="pre">Interface</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.default_config_file"><code class="docutils literal notranslate"><span class="pre">Interface.default_config_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.directory"><code class="docutils literal notranslate"><span class="pre">Interface.directory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.user_file"><code class="docutils literal notranslate"><span class="pre">Interface.user_file</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.from_file"><code class="docutils literal notranslate"><span class="pre">Interface.from_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.from_yaml"><code class="docutils literal notranslate"><span class="pre">Interface.from_yaml()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.get"><code class="docutils literal notranslate"><span class="pre">Interface.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.get_cache_columns"><code class="docutils literal notranslate"><span class="pre">Interface.get_cache_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.get_output_columns"><code class="docutils literal notranslate"><span class="pre">Interface.get_output_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.items"><code class="docutils literal notranslate"><span class="pre">Interface.items()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.keys"><code class="docutils literal notranslate"><span class="pre">Interface.keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.to_yaml"><code class="docutils literal notranslate"><span class="pre">Interface.to_yaml()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.update"><code class="docutils literal notranslate"><span class="pre">Interface.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/config.html#referia.config.interface.Interface.values"><code class="docutils literal notranslate"><span class="pre">Interface.values()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/config.html#inheritance-relationship">Inheritance Relationship</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/config.html#configuration-file-format">Configuration File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/config.html#usage-example">Usage Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/util.html">Utility Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/util.html#text-utilities">Text Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.text.split_into_sentences"><code class="docutils literal notranslate"><span class="pre">split_into_sentences()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.text.render_liquid"><code class="docutils literal notranslate"><span class="pre">render_liquid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.text.comment_list"><code class="docutils literal notranslate"><span class="pre">comment_list()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.text.word_count"><code class="docutils literal notranslate"><span class="pre">word_count()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.text.word_cloud"><code class="docutils literal notranslate"><span class="pre">word_cloud()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.text.paragraph_split"><code class="docutils literal notranslate"><span class="pre">paragraph_split()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.text.sentence_split"><code class="docutils literal notranslate"><span class="pre">sentence_split()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.text.list_lengths"><code class="docutils literal notranslate"><span class="pre">list_lengths()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.text.named_entities"><code class="docutils literal notranslate"><span class="pre">named_entities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.text.text_summarizer"><code class="docutils literal notranslate"><span class="pre">text_summarizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.text.pdf_extract_comments"><code class="docutils literal notranslate"><span class="pre">pdf_extract_comments()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/util.html#file-utilities">File Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.files.file_from_re"><code class="docutils literal notranslate"><span class="pre">file_from_re()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.files.files_from_re"><code class="docutils literal notranslate"><span class="pre">files_from_re()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.files.to_valid_file"><code class="docutils literal notranslate"><span class="pre">to_valid_file()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/util.html#plotting-utilities">Plotting Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.plot.write_figure"><code class="docutils literal notranslate"><span class="pre">write_figure()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.plot.bar_plot"><code class="docutils literal notranslate"><span class="pre">bar_plot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.plot.histogram"><code class="docutils literal notranslate"><span class="pre">histogram()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/util.html#miscellaneous-utilities">Miscellaneous Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.identity"><code class="docutils literal notranslate"><span class="pre">identity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.filename_to_binary"><code class="docutils literal notranslate"><span class="pre">filename_to_binary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.yyyymmddToDatetime"><code class="docutils literal notranslate"><span class="pre">yyyymmddToDatetime()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.datetimeToYyyymmdd"><code class="docutils literal notranslate"><span class="pre">datetimeToYyyymmdd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.add_one_to_max"><code class="docutils literal notranslate"><span class="pre">add_one_to_max()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.renderable"><code class="docutils literal notranslate"><span class="pre">renderable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.tallyable"><code class="docutils literal notranslate"><span class="pre">tallyable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.notempty"><code class="docutils literal notranslate"><span class="pre">notempty()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.draft_combinator"><code class="docutils literal notranslate"><span class="pre">draft_combinator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.mapping"><code class="docutils literal notranslate"><span class="pre">mapping()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.draft_skills"><code class="docutils literal notranslate"><span class="pre">draft_skills()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.return_longest"><code class="docutils literal notranslate"><span class="pre">return_longest()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.misc.return_shortest"><code class="docutils literal notranslate"><span class="pre">return_shortest()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/util.html#system-utilities">System Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.system.most_recent_screen_shot"><code class="docutils literal notranslate"><span class="pre">most_recent_screen_shot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/util.html#widget-utilities">Widget Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaWidget"><code class="docutils literal notranslate"><span class="pre">ReferiaWidget</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaWidget.name"><code class="docutils literal notranslate"><span class="pre">ReferiaWidget.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaWidget.description"><code class="docutils literal notranslate"><span class="pre">ReferiaWidget.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaWidget.close"><code class="docutils literal notranslate"><span class="pre">ReferiaWidget.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaWidget.on_click"><code class="docutils literal notranslate"><span class="pre">ReferiaWidget.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaWidget.refresh"><code class="docutils literal notranslate"><span class="pre">ReferiaWidget.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaWidget.widget"><code class="docutils literal notranslate"><span class="pre">ReferiaWidget.widget</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaWidget.private"><code class="docutils literal notranslate"><span class="pre">ReferiaWidget.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaWidget.display"><code class="docutils literal notranslate"><span class="pre">ReferiaWidget.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaWidget.null"><code class="docutils literal notranslate"><span class="pre">ReferiaWidget.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaWidget.to_markdown"><code class="docutils literal notranslate"><span class="pre">ReferiaWidget.to_markdown()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.private"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.name"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.on_value_change"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.on_value_change()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.get_value"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.get_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.get_layout"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.get_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.get_description"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.get_description()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.set_value"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.set_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.set_value_silently"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.set_value_silently()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.reset_value"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.reset_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.get_column"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.get_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.to_markdown"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.close"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.description"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.display"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.null"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.on_click"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.refresh"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaStatefulWidget.widget"><code class="docutils literal notranslate"><span class="pre">ReferiaStatefulWidget.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget"><code class="docutils literal notranslate"><span class="pre">FieldWidget</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.on_value_change"><code class="docutils literal notranslate"><span class="pre">FieldWidget.on_value_change()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.has_viewer"><code class="docutils literal notranslate"><span class="pre">FieldWidget.has_viewer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.refresh"><code class="docutils literal notranslate"><span class="pre">FieldWidget.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.close"><code class="docutils literal notranslate"><span class="pre">FieldWidget.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.description"><code class="docutils literal notranslate"><span class="pre">FieldWidget.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.display"><code class="docutils literal notranslate"><span class="pre">FieldWidget.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.get_column"><code class="docutils literal notranslate"><span class="pre">FieldWidget.get_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.get_description"><code class="docutils literal notranslate"><span class="pre">FieldWidget.get_description()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.get_layout"><code class="docutils literal notranslate"><span class="pre">FieldWidget.get_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.get_value"><code class="docutils literal notranslate"><span class="pre">FieldWidget.get_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.name"><code class="docutils literal notranslate"><span class="pre">FieldWidget.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.null"><code class="docutils literal notranslate"><span class="pre">FieldWidget.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.on_click"><code class="docutils literal notranslate"><span class="pre">FieldWidget.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.private"><code class="docutils literal notranslate"><span class="pre">FieldWidget.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.reset_value"><code class="docutils literal notranslate"><span class="pre">FieldWidget.reset_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.set_value"><code class="docutils literal notranslate"><span class="pre">FieldWidget.set_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.set_value_silently"><code class="docutils literal notranslate"><span class="pre">FieldWidget.set_value_silently()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.to_markdown"><code class="docutils literal notranslate"><span class="pre">FieldWidget.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FieldWidget.widget"><code class="docutils literal notranslate"><span class="pre">FieldWidget.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget"><code class="docutils literal notranslate"><span class="pre">ElementWidget</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.get_element"><code class="docutils literal notranslate"><span class="pre">ElementWidget.get_element()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.set_element"><code class="docutils literal notranslate"><span class="pre">ElementWidget.set_element()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.on_value_change"><code class="docutils literal notranslate"><span class="pre">ElementWidget.on_value_change()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.has_viewer"><code class="docutils literal notranslate"><span class="pre">ElementWidget.has_viewer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.refresh"><code class="docutils literal notranslate"><span class="pre">ElementWidget.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.close"><code class="docutils literal notranslate"><span class="pre">ElementWidget.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.description"><code class="docutils literal notranslate"><span class="pre">ElementWidget.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.display"><code class="docutils literal notranslate"><span class="pre">ElementWidget.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.get_column"><code class="docutils literal notranslate"><span class="pre">ElementWidget.get_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.get_description"><code class="docutils literal notranslate"><span class="pre">ElementWidget.get_description()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.get_layout"><code class="docutils literal notranslate"><span class="pre">ElementWidget.get_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.get_value"><code class="docutils literal notranslate"><span class="pre">ElementWidget.get_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.name"><code class="docutils literal notranslate"><span class="pre">ElementWidget.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.null"><code class="docutils literal notranslate"><span class="pre">ElementWidget.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.on_click"><code class="docutils literal notranslate"><span class="pre">ElementWidget.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.private"><code class="docutils literal notranslate"><span class="pre">ElementWidget.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.reset_value"><code class="docutils literal notranslate"><span class="pre">ElementWidget.reset_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.set_value"><code class="docutils literal notranslate"><span class="pre">ElementWidget.set_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.set_value_silently"><code class="docutils literal notranslate"><span class="pre">ElementWidget.set_value_silently()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.to_markdown"><code class="docutils literal notranslate"><span class="pre">ElementWidget.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementWidget.widget"><code class="docutils literal notranslate"><span class="pre">ElementWidget.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector"><code class="docutils literal notranslate"><span class="pre">IndexSelector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.private"><code class="docutils literal notranslate"><span class="pre">IndexSelector.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.on_value_change"><code class="docutils literal notranslate"><span class="pre">IndexSelector.on_value_change()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.set_index"><code class="docutils literal notranslate"><span class="pre">IndexSelector.set_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.refresh"><code class="docutils literal notranslate"><span class="pre">IndexSelector.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.close"><code class="docutils literal notranslate"><span class="pre">IndexSelector.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.description"><code class="docutils literal notranslate"><span class="pre">IndexSelector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.display"><code class="docutils literal notranslate"><span class="pre">IndexSelector.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.get_column"><code class="docutils literal notranslate"><span class="pre">IndexSelector.get_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.get_description"><code class="docutils literal notranslate"><span class="pre">IndexSelector.get_description()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.get_layout"><code class="docutils literal notranslate"><span class="pre">IndexSelector.get_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.get_value"><code class="docutils literal notranslate"><span class="pre">IndexSelector.get_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.name"><code class="docutils literal notranslate"><span class="pre">IndexSelector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.null"><code class="docutils literal notranslate"><span class="pre">IndexSelector.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.on_click"><code class="docutils literal notranslate"><span class="pre">IndexSelector.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.reset_value"><code class="docutils literal notranslate"><span class="pre">IndexSelector.reset_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.set_value"><code class="docutils literal notranslate"><span class="pre">IndexSelector.set_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.set_value_silently"><code class="docutils literal notranslate"><span class="pre">IndexSelector.set_value_silently()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.to_markdown"><code class="docutils literal notranslate"><span class="pre">IndexSelector.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSelector.widget"><code class="docutils literal notranslate"><span class="pre">IndexSelector.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.add_stateful"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.add_stateful()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.update_side_effects"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.update_side_effects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.add_stateless"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.add_stateless()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.display"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.close"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.description"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.get_column"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.get_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.get_description"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.get_description()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.get_layout"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.get_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.get_value"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.get_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.name"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.null"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.on_click"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.on_value_change"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.on_value_change()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.private"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.refresh"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.reset_value"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.reset_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.set_value"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.set_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.set_value_silently"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.set_value_silently()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.to_markdown"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaMultiWidget.widget"><code class="docutils literal notranslate"><span class="pre">ReferiaMultiWidget.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture"><code class="docutils literal notranslate"><span class="pre">ScreenCapture</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.add_stateful"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.add_stateful()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.add_stateless"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.add_stateless()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.close"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.description"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.display"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.get_column"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.get_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.get_description"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.get_description()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.get_layout"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.get_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.get_value"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.get_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.name"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.null"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.on_click"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.on_value_change"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.on_value_change()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.private"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.refresh"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.reset_value"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.reset_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.set_value"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.set_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.set_value_silently"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.set_value_silently()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.to_markdown"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.update_side_effects"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.update_side_effects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ScreenCapture.widget"><code class="docutils literal notranslate"><span class="pre">ScreenCapture.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector"><code class="docutils literal notranslate"><span class="pre">FullSelector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.add_stateful"><code class="docutils literal notranslate"><span class="pre">FullSelector.add_stateful()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.add_stateless"><code class="docutils literal notranslate"><span class="pre">FullSelector.add_stateless()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.close"><code class="docutils literal notranslate"><span class="pre">FullSelector.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.description"><code class="docutils literal notranslate"><span class="pre">FullSelector.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.display"><code class="docutils literal notranslate"><span class="pre">FullSelector.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.get_column"><code class="docutils literal notranslate"><span class="pre">FullSelector.get_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.get_description"><code class="docutils literal notranslate"><span class="pre">FullSelector.get_description()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.get_layout"><code class="docutils literal notranslate"><span class="pre">FullSelector.get_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.get_value"><code class="docutils literal notranslate"><span class="pre">FullSelector.get_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.name"><code class="docutils literal notranslate"><span class="pre">FullSelector.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.null"><code class="docutils literal notranslate"><span class="pre">FullSelector.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.on_click"><code class="docutils literal notranslate"><span class="pre">FullSelector.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.on_value_change"><code class="docutils literal notranslate"><span class="pre">FullSelector.on_value_change()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.private"><code class="docutils literal notranslate"><span class="pre">FullSelector.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.refresh"><code class="docutils literal notranslate"><span class="pre">FullSelector.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.reset_value"><code class="docutils literal notranslate"><span class="pre">FullSelector.reset_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.set_value"><code class="docutils literal notranslate"><span class="pre">FullSelector.set_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.set_value_silently"><code class="docutils literal notranslate"><span class="pre">FullSelector.set_value_silently()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.to_markdown"><code class="docutils literal notranslate"><span class="pre">FullSelector.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.update_side_effects"><code class="docutils literal notranslate"><span class="pre">FullSelector.update_side_effects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FullSelector.widget"><code class="docutils literal notranslate"><span class="pre">FullSelector.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.on_value_change"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.on_value_change()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.set_index"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.set_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.add_stateful"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.add_stateful()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.add_stateless"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.add_stateless()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.close"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.description"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.display"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.get_column"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.get_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.get_description"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.get_description()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.get_layout"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.get_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.get_value"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.get_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.name"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.null"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.on_click"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.private"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.refresh"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.reset_value"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.reset_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.set_value"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.set_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.set_value_silently"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.set_value_silently()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.to_markdown"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.update_side_effects"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.update_side_effects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IndexSubIndexSelectorSelect.widget"><code class="docutils literal notranslate"><span class="pre">IndexSubIndexSelectorSelect.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaButtonWidget"><code class="docutils literal notranslate"><span class="pre">ReferiaButtonWidget</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaButtonWidget.name"><code class="docutils literal notranslate"><span class="pre">ReferiaButtonWidget.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaButtonWidget.on_click"><code class="docutils literal notranslate"><span class="pre">ReferiaButtonWidget.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaButtonWidget.refresh"><code class="docutils literal notranslate"><span class="pre">ReferiaButtonWidget.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaButtonWidget.close"><code class="docutils literal notranslate"><span class="pre">ReferiaButtonWidget.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaButtonWidget.description"><code class="docutils literal notranslate"><span class="pre">ReferiaButtonWidget.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaButtonWidget.display"><code class="docutils literal notranslate"><span class="pre">ReferiaButtonWidget.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaButtonWidget.null"><code class="docutils literal notranslate"><span class="pre">ReferiaButtonWidget.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaButtonWidget.private"><code class="docutils literal notranslate"><span class="pre">ReferiaButtonWidget.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaButtonWidget.to_markdown"><code class="docutils literal notranslate"><span class="pre">ReferiaButtonWidget.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReferiaButtonWidget.widget"><code class="docutils literal notranslate"><span class="pre">ReferiaButtonWidget.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateDocButton"><code class="docutils literal notranslate"><span class="pre">CreateDocButton</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateDocButton.on_click"><code class="docutils literal notranslate"><span class="pre">CreateDocButton.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateDocButton.close"><code class="docutils literal notranslate"><span class="pre">CreateDocButton.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateDocButton.description"><code class="docutils literal notranslate"><span class="pre">CreateDocButton.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateDocButton.display"><code class="docutils literal notranslate"><span class="pre">CreateDocButton.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateDocButton.name"><code class="docutils literal notranslate"><span class="pre">CreateDocButton.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateDocButton.null"><code class="docutils literal notranslate"><span class="pre">CreateDocButton.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateDocButton.private"><code class="docutils literal notranslate"><span class="pre">CreateDocButton.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateDocButton.refresh"><code class="docutils literal notranslate"><span class="pre">CreateDocButton.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateDocButton.to_markdown"><code class="docutils literal notranslate"><span class="pre">CreateDocButton.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateDocButton.widget"><code class="docutils literal notranslate"><span class="pre">CreateDocButton.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryDocButton"><code class="docutils literal notranslate"><span class="pre">CreateSummaryDocButton</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryDocButton.on_click"><code class="docutils literal notranslate"><span class="pre">CreateSummaryDocButton.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryDocButton.close"><code class="docutils literal notranslate"><span class="pre">CreateSummaryDocButton.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryDocButton.description"><code class="docutils literal notranslate"><span class="pre">CreateSummaryDocButton.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryDocButton.display"><code class="docutils literal notranslate"><span class="pre">CreateSummaryDocButton.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryDocButton.name"><code class="docutils literal notranslate"><span class="pre">CreateSummaryDocButton.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryDocButton.null"><code class="docutils literal notranslate"><span class="pre">CreateSummaryDocButton.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryDocButton.private"><code class="docutils literal notranslate"><span class="pre">CreateSummaryDocButton.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryDocButton.refresh"><code class="docutils literal notranslate"><span class="pre">CreateSummaryDocButton.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryDocButton.to_markdown"><code class="docutils literal notranslate"><span class="pre">CreateSummaryDocButton.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryDocButton.widget"><code class="docutils literal notranslate"><span class="pre">CreateSummaryDocButton.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryButton"><code class="docutils literal notranslate"><span class="pre">CreateSummaryButton</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryButton.on_click"><code class="docutils literal notranslate"><span class="pre">CreateSummaryButton.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryButton.close"><code class="docutils literal notranslate"><span class="pre">CreateSummaryButton.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryButton.description"><code class="docutils literal notranslate"><span class="pre">CreateSummaryButton.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryButton.display"><code class="docutils literal notranslate"><span class="pre">CreateSummaryButton.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryButton.name"><code class="docutils literal notranslate"><span class="pre">CreateSummaryButton.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryButton.null"><code class="docutils literal notranslate"><span class="pre">CreateSummaryButton.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryButton.private"><code class="docutils literal notranslate"><span class="pre">CreateSummaryButton.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryButton.refresh"><code class="docutils literal notranslate"><span class="pre">CreateSummaryButton.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryButton.to_markdown"><code class="docutils literal notranslate"><span class="pre">CreateSummaryButton.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.CreateSummaryButton.widget"><code class="docutils literal notranslate"><span class="pre">CreateSummaryButton.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.SaveButton"><code class="docutils literal notranslate"><span class="pre">SaveButton</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.SaveButton.on_click"><code class="docutils literal notranslate"><span class="pre">SaveButton.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.SaveButton.close"><code class="docutils literal notranslate"><span class="pre">SaveButton.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.SaveButton.description"><code class="docutils literal notranslate"><span class="pre">SaveButton.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.SaveButton.display"><code class="docutils literal notranslate"><span class="pre">SaveButton.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.SaveButton.name"><code class="docutils literal notranslate"><span class="pre">SaveButton.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.SaveButton.null"><code class="docutils literal notranslate"><span class="pre">SaveButton.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.SaveButton.private"><code class="docutils literal notranslate"><span class="pre">SaveButton.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.SaveButton.refresh"><code class="docutils literal notranslate"><span class="pre">SaveButton.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.SaveButton.to_markdown"><code class="docutils literal notranslate"><span class="pre">SaveButton.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.SaveButton.widget"><code class="docutils literal notranslate"><span class="pre">SaveButton.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReloadButton"><code class="docutils literal notranslate"><span class="pre">ReloadButton</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReloadButton.on_click"><code class="docutils literal notranslate"><span class="pre">ReloadButton.on_click()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReloadButton.close"><code class="docutils literal notranslate"><span class="pre">ReloadButton.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReloadButton.description"><code class="docutils literal notranslate"><span class="pre">ReloadButton.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReloadButton.display"><code class="docutils literal notranslate"><span class="pre">ReloadButton.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReloadButton.name"><code class="docutils literal notranslate"><span class="pre">ReloadButton.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReloadButton.null"><code class="docutils literal notranslate"><span class="pre">ReloadButton.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReloadButton.private"><code class="docutils literal notranslate"><span class="pre">ReloadButton.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReloadButton.refresh"><code class="docutils literal notranslate"><span class="pre">ReloadButton.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReloadButton.to_markdown"><code class="docutils literal notranslate"><span class="pre">ReloadButton.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ReloadButton.widget"><code class="docutils literal notranslate"><span class="pre">ReloadButton.widget</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.PopulateButton"><code class="docutils literal notranslate"><span class="pre">PopulateButton</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.PopulateButton.close"><code class="docutils literal notranslate"><span class="pre">PopulateButton.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.PopulateButton.description"><code class="docutils literal notranslate"><span class="pre">PopulateButton.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.PopulateButton.display"><code class="docutils literal notranslate"><span class="pre">PopulateButton.display()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.PopulateButton.name"><code class="docutils literal notranslate"><span class="pre">PopulateButton.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.PopulateButton.null"><code class="docutils literal notranslate"><span class="pre">PopulateButton.null()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.PopulateButton.private"><code class="docutils literal notranslate"><span class="pre">PopulateButton.private</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.PopulateButton.refresh"><code class="docutils literal notranslate"><span class="pre">PopulateButton.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.PopulateButton.to_markdown"><code class="docutils literal notranslate"><span class="pre">PopulateButton.to_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.PopulateButton.widget"><code class="docutils literal notranslate"><span class="pre">PopulateButton.widget</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.PopulateButton.on_click"><code class="docutils literal notranslate"><span class="pre">PopulateButton.on_click()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.BoundedFloatText"><code class="docutils literal notranslate"><span class="pre">BoundedFloatText()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.Checkbox"><code class="docutils literal notranslate"><span class="pre">Checkbox()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.Combobox"><code class="docutils literal notranslate"><span class="pre">Combobox()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.DatePicker"><code class="docutils literal notranslate"><span class="pre">DatePicker()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.Dropdown"><code class="docutils literal notranslate"><span class="pre">Dropdown()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementBoundedFloatText"><code class="docutils literal notranslate"><span class="pre">ElementBoundedFloatText()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementCheckbox"><code class="docutils literal notranslate"><span class="pre">ElementCheckbox()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementCombobox"><code class="docutils literal notranslate"><span class="pre">ElementCombobox()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementDatePicker"><code class="docutils literal notranslate"><span class="pre">ElementDatePicker()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementDropdown"><code class="docutils literal notranslate"><span class="pre">ElementDropdown()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementFlag"><code class="docutils literal notranslate"><span class="pre">ElementFlag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementFloatSlider"><code class="docutils literal notranslate"><span class="pre">ElementFloatSlider()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementHTML"><code class="docutils literal notranslate"><span class="pre">ElementHTML()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementHTMLMath"><code class="docutils literal notranslate"><span class="pre">ElementHTMLMath()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementIntSlider"><code class="docutils literal notranslate"><span class="pre">ElementIntSlider()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementIntText"><code class="docutils literal notranslate"><span class="pre">ElementIntText()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementLabel"><code class="docutils literal notranslate"><span class="pre">ElementLabel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementLayout"><code class="docutils literal notranslate"><span class="pre">ElementLayout()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementMarkdown"><code class="docutils literal notranslate"><span class="pre">ElementMarkdown()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementPngImageFile"><code class="docutils literal notranslate"><span class="pre">ElementPngImageFile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementRadioButtons"><code class="docutils literal notranslate"><span class="pre">ElementRadioButtons()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementSelect"><code class="docutils literal notranslate"><span class="pre">ElementSelect()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementSelectMultiple"><code class="docutils literal notranslate"><span class="pre">ElementSelectMultiple()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementText"><code class="docutils literal notranslate"><span class="pre">ElementText()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.ElementTextarea"><code class="docutils literal notranslate"><span class="pre">ElementTextarea()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.Flag"><code class="docutils literal notranslate"><span class="pre">Flag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.FloatSlider"><code class="docutils literal notranslate"><span class="pre">FloatSlider()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.HTML"><code class="docutils literal notranslate"><span class="pre">HTML()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.HTMLMath"><code class="docutils literal notranslate"><span class="pre">HTMLMath()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IntSlider"><code class="docutils literal notranslate"><span class="pre">IntSlider()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.IntText"><code class="docutils literal notranslate"><span class="pre">IntText()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.Label"><code class="docutils literal notranslate"><span class="pre">Label()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.Layout"><code class="docutils literal notranslate"><span class="pre">Layout()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.Markdown"><code class="docutils literal notranslate"><span class="pre">Markdown()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.PngImageFile"><code class="docutils literal notranslate"><span class="pre">PngImageFile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.RadioButtons"><code class="docutils literal notranslate"><span class="pre">RadioButtons()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.Select"><code class="docutils literal notranslate"><span class="pre">Select()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.SelectMultiple"><code class="docutils literal notranslate"><span class="pre">SelectMultiple()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.Text"><code class="docutils literal notranslate"><span class="pre">Text()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.Textarea"><code class="docutils literal notranslate"><span class="pre">Textarea()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.gocf_"><code class="docutils literal notranslate"><span class="pre">gocf_()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.gsv_"><code class="docutils literal notranslate"><span class="pre">gsv_()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.gwc_"><code class="docutils literal notranslate"><span class="pre">gwc_()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.gwu_"><code class="docutils literal notranslate"><span class="pre">gwu_()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.gwf_"><code class="docutils literal notranslate"><span class="pre">gwf_()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.gwef_"><code class="docutils literal notranslate"><span class="pre">gwef_()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.populate_widgets"><code class="docutils literal notranslate"><span class="pre">populate_widgets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.populate_element_widgets"><code class="docutils literal notranslate"><span class="pre">populate_element_widgets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.MyFileChooser"><code class="docutils literal notranslate"><span class="pre">MyFileChooser()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.interact"><code class="docutils literal notranslate"><span class="pre">interact()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.interact_manual"><code class="docutils literal notranslate"><span class="pre">interact_manual()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/util.html#referia.util.widgets.interactive"><code class="docutils literal notranslate"><span class="pre">interactive()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/util.html#relationship-with-lynguine-utilities">Relationship with Lynguine Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../inheritance.html">Inheritance Relationships</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../inheritance.html#compute-class">Compute Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../inheritance.html#data-classes">Data Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../inheritance.html#configuration-system">Configuration System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../inheritance.html#utility-functions">Utility Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../inheritance.html#best-practices-for-developers">Best Practices for Developers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing to Referia</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#development-setup">Development Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#code-structure">Code Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#documentation-standards">Documentation Standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#inheritance-guidelines">Inheritance Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#working-with-both-codebases">Working with Both Codebases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#pull-request-process">Pull Request Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#building-documentation">Building Documentation</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">referia</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">lynguine.assess.data</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for lynguine.assess.data</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">keyword</span><span class="w"> </span><span class="kn">import</span> <span class="n">iskeyword</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">..</span><span class="w"> </span><span class="kn">import</span> <span class="n">access</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..log</span><span class="w"> </span><span class="kn">import</span> <span class="n">Logger</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..config.context</span><span class="w"> </span><span class="kn">import</span> <span class="n">Context</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..config.interface</span><span class="w"> </span><span class="kn">import</span> <span class="n">Interface</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..util.misc</span><span class="w"> </span><span class="kn">import</span> <span class="n">remove_nan</span><span class="p">,</span> <span class="n">to_camel_case</span><span class="p">,</span> <span class="n">is_valid_var</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">..assess.compute</span><span class="w"> </span><span class="kn">import</span> <span class="n">Compute</span>

<span class="sd">&quot;&quot;&quot;Wrapper classes for data objects&quot;&quot;&quot;</span>

<span class="n">ctxt</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="n">ctxt</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;logging&quot;</span><span class="p">][</span><span class="s2">&quot;level&quot;</span><span class="p">],</span>
    <span class="n">filename</span><span class="o">=</span><span class="n">ctxt</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;logging&quot;</span><span class="p">][</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span>
<span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Accessor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This is a base accessor class&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This is a base accessor class&quot;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DataObject</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colspecs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subindex</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">at</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_AtAccessor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_IlocAccessor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_locAccessor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;lynguine.assess.data.DataObject initialiser called.&quot;</span><span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">_AtAccessor</span><span class="p">(</span><span class="n">Accessor</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">_LocAccessor</span><span class="p">(</span><span class="n">Accessor</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">_IlocAccessor</span><span class="p">(</span><span class="n">Accessor</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_subindex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This is a base class&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_subindex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This is a base class&quot;</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">get_subseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the subseries that is the focus for the DataFrame.</span>

<span class="sd">        :return: The subseries that is the focus for the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The series types are stored in cls.types[&quot;series&quot;]</span>
        <span class="c1"># Extract DataFrames from that class and merge them.</span>
        <span class="n">series</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>            
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">colspecs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">colspecs</span><span class="p">[</span><span class="n">typ</span><span class="p">]:</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">][</span><span class="n">col</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">series</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">series</span> <span class="o">=</span> <span class="n">data</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">series</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>

        <span class="c1"># Use the in focus index to choose which part of the series is returned.</span>
        <span class="k">return</span> <span class="n">series</span><span class="p">[</span><span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">()])]</span>
    

    <span class="k">def</span><span class="w"> </span><span class="nf">get_subindices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the subindices that are the focus for the DataFrame.</span>

<span class="sd">        :return: The subindices that are the focus for the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">subseries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subseries</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">subseries</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;object&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> in the subseries when using it as a selector.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_subseries_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a pd.Series containing all the values in a column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">column</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span>

        <span class="n">typ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_source</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isseries</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
            <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">index</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">indexer</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">indexer</span><span class="p">,</span> <span class="n">column</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data available with index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> returning None.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is not a series column, type is </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> returning </span><span class="se">\&quot;</span><span class="s2">None</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">get_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the index that is the focus for the DataFrame.</span>

<span class="sd">        :return: The index that is the focus for the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_index&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span> <span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the index to be the focus for the DataFrame.</span>

<span class="sd">        :param index: The index to set.</span>
<span class="sd">        :raise KeyError: If the index is not in the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Setting index to None.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting index to </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>            
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">index</span>
                
        <span class="k">else</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> not found in data&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
 

    <span class="k">def</span><span class="w"> </span><span class="nf">get_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the column that is the focus for the DataFrame.</span>

<span class="sd">        :return: The column that is the focus for the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the column to be the focus for the DataFrame.</span>

<span class="sd">        :param column: The column to set.</span>
<span class="sd">        :raise KeyError: If the column is not in the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">column</span> <span class="o">==</span> <span class="s2">&quot;_&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_column</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Set column to </span><span class="se">\&quot;</span><span class="s2">_</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_column</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Set column to </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Was asked to set column to None.&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="c1"># Note column is not being set here.</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">column</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="c1"># In the vrs 0.1.0 this used to warn and run self.add_column(column)</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Attempting to add column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> as a set request has been given to non existent column.&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_column</span> <span class="o">=</span> <span class="n">column</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_value_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a value to a column in the write data frame</span>

<span class="sd">        :param value: The value to be set.</span>
<span class="sd">        :type value: object</span>
<span class="sd">        :param column: The column to set the value in.</span>
<span class="sd">        :type column: str</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">orig_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">orig_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">orig_col</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_value_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a value from a column in the data frame(s)</span>

<span class="sd">        :param column: The column to get the value from.</span>
<span class="sd">        :type column: str</span>
<span class="sd">        :return: The value from the column.</span>
<span class="sd">        :rtype: object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">orig_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">orig_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">orig_col</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ismutable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is a given column mutable?</span>

<span class="sd">        :param column: The column to check.</span>
<span class="sd">        :return: True if the column is mutable, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">autocache</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_source</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">isseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is a given column a series column?</span>

<span class="sd">        :param column: The column to check.</span>
<span class="sd">        :return: True if the column is a series column, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_source</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">autocache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether the data structure will automatically cache values.</span>

<span class="sd">        :return True if the data structure will automatically cache values, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_autocache</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@autocache</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">autocache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether the data structure will automatically cache values.</span>

<span class="sd">        :param value: The value to set.</span>
<span class="sd">        :raise ValueError: If the value is not boolean.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;autocache value must be boolean, set as </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_autocache</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the interface object.</span>
<span class="sd">        :return: The interface object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interface</span>

    <span class="nd">@interface</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">interface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the interface object.</span>
<span class="sd">        :param value: The interface object.</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">Interface</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Interface must be of type Interface or dict. Type provided is </span><span class="se">\&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">..&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interface</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mutable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is the data structure mutable.</span>

<span class="sd">        :return True if the data structure is mutable, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">autocache</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">_col_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the source of a column.</span>

<span class="sd">        :param column: The column to check.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">typ</span>
            <span class="k">elif</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">typ</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">autocache</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;cache&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">isparameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test if the column is a given column a parameter (i.e. applicable for all rows)?</span>

<span class="sd">        :param column: The column to check.</span>
<span class="sd">        :return: True if the column is a parameter, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_source</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">isseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test if a given column is a series column (i.e. one where the index can be repeated and have multiple rows associated with it).</span>

<span class="sd">        :param column: The column to check.</span>
<span class="sd">        :return: True if the column is a series column, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_source</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">get_selector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the selector that is the focus for the DataFrame.</span>

<span class="sd">        The selector is the column used to disambiguate a series in</span>
<span class="sd">        the focus.</span>

<span class="sd">        :return: The selector that is the focus for the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span>

    
    <span class="k">def</span><span class="w"> </span><span class="nf">set_selector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the selector that is the focus for the DataFrame.</span>

<span class="sd">        The selector</span>

<span class="sd">        :param column: The column to set the selector to.</span>
<span class="sd">        :raise KeyError: If the column is not in the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No column selected for selector, setting to </span><span class="se">\&quot;</span><span class="s2">None</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isseries</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span> <span class="o">=</span> <span class="n">column</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> of CustomDataFrame selected for selection.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subindex</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subindex </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_subindex</span><span class="p">()</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> not found in column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">, resetting to None.&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_subindex</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is not a series column.&quot;</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Invalid selector set.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_subindex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the subindex that is the focus for the DataFrame.</span>
<span class="sd">        The subindex is the index used to disambiguate a series in</span>
<span class="sd">        the focus.</span>

<span class="sd">        :return: The subindex that is the focus for the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subindex is None. Attempt to extract subindex from last row.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subindices</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subindices</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subindex set to </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_subindex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span> <span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the subindex that is the focus for the DataFrame.</span>

<span class="sd">        If the subindex is set to None, the last row of the subseries</span>
<span class="sd">        is returned. The last row is assumed to be the most recent.</span>

<span class="sd">        :param index: The index to set the subindex to.</span>
<span class="sd">        :raise KeyError: If the index is not in the DataFrame.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Will select the last row.</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subindices</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span> <span class="o">=</span> <span class="n">index</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Invalid subindex set.&quot;</span><span class="p">)</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">get_selectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return valid selectors, these are columns that are present in the type &quot;series&quot;</span>
<span class="sd">        :return: The valid selectors.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># iterate through the colspecs finding columns of type series</span>
        <span class="n">selectors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">col</span>
            <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">colspecs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">typ</span><span class="p">,</span> <span class="p">[])</span>
        <span class="p">]</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span> <span class="ow">in</span> <span class="n">selectors</span><span class="p">:</span>
            <span class="c1"># Return selectors with selector at front (to ensure it is default) for widgets)</span>
            <span class="n">selectors</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">selectors</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">selectors</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">selectors</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the value that is in the cell defined as focus for the DataFrame.</span>

<span class="sd">        :return: The value that is the focus for the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check whether the column is a series column.</span>

        <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">()</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">index</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting value for index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> and column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value is </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">val</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isseries</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
            <span class="c1"># If it is a series column, return the element of val where the self._selector column equals the self._subindex value.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">errmsg</span> <span class="o">=</span> <span class="s2">&quot;Selector not set.&quot;</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subindex</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subindex not set, will default to last row.&quot;</span><span class="p">)</span>
                <span class="n">selection</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">selection</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multiple values found for selector </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> and subindex </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">. returning the last.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">selection</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is not a series column and yet the return value from it was a series..&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the value that is in the cell defined as focus for the DataFrame.</span>

<span class="sd">        :param value: The value to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">()</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isseries</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A set_value() attempted when selector not set for a series column.&quot;</span><span class="p">)</span>
            
            <span class="n">typ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column_type</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="n">series_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span>

            <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">series_df</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">index</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Find the row(s) that match both the index and subindex</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">series_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span><span class="p">)</span>
                
            
            <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># If no matching row, create a new one</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No matching rows found for index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> and subindex </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> in selector column </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">. Creating a new row.&quot;</span><span class="p">)</span>
                <span class="n">new_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span><span class="p">],</span> <span class="n">col</span><span class="p">:</span> <span class="p">[</span><span class="n">value</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                <span class="n">series_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">series_df</span><span class="p">,</span> <span class="n">new_row</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># If one matching row, update it</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;One matching row found for index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> and subindex </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> in selector column </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">. Updating it.&quot;</span><span class="p">)</span>
                <span class="n">series_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># If multiple matching rows, update the last row and warn</span>
                <span class="c1"># This is a chained assignment</span>
                <span class="c1">#series_df.loc[mask, col].iloc[-1] = value</span>
                <span class="c1"># This code attempts to get around that.</span>
                <span class="n">index_last_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mask</span><span class="p">)))[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Last position is </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index_last_val</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="n">series_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index_last_val</span><span class="p">,</span> <span class="n">series_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">col</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multiple rows found for index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> and subindex </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> in selector column </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">. Updating only the last occurrence.&quot;</span><span class="p">)</span>

            <span class="c1"># Update the data object with the modified data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_df</span>

        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Set value </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> for index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">, column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">, selector </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">, subindex </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>

    
    <span class="k">def</span><span class="w"> </span><span class="nf">add_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">typ</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a new row to the CustomDataFrame for the current column in focus.</span>

<span class="sd">        :param index: The index of the new row to be added.</span>
<span class="sd">        :param typ: The type of row being added.</span>
<span class="sd">        :param values: A dictionary of column:value pairs for the new row. If None, adds NaN values.</span>
<span class="sd">        :raises ValueError: If the index already exists or if it&#39;s not possible to add the row.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">typ</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">current_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">()</span>
            <span class="n">typ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column_type</span><span class="p">(</span><span class="n">current_column</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Current column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">current_column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> not found in any dataframe.&quot;</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Cannot add row to input type </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span>

        <span class="c1"># Don&#39;t allow adding a row if the type is parameters</span>
        <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="s2">&quot;Cannot add row to parameters type. Use set_value() to modify parameters.&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

        <span class="c1"># Don&#39;t allow adding a row if the index already exists and the type is not a series</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="ow">and</span> <span class="n">typ</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> already exists in </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]:</span>
            <span class="c1"># For series, we allow multiple rows with the same index</span>
            <span class="n">new_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">new_row</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">if</span> <span class="n">values</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># For non-series types</span>
            <span class="n">new_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">new_row</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                        <span class="n">new_row</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">new_row</span><span class="p">])</span>


        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added new row with index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> to </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> dataframe.&quot;</span><span class="p">)</span>

    
    <span class="k">def</span><span class="w"> </span><span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the first `n` rows of the DataFrame.</span>

<span class="sd">        :param n: Number of rows to select.</span>
<span class="sd">        :return: The first `n` rows of the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the last `n` rows of the DataFrame.</span>

<span class="sd">        :param n: Number of rows to select.</span>
<span class="sd">        :return: The last `n` rows of the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a new column to the DataFrame.</span>

<span class="sd">        :param column_name: The name of the new column.</span>
<span class="sd">        :param data: The data for the new column.</span>
<span class="sd">        :raise NotImplementedError: Indicates the method needs to be implemented in a subclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This is a base class&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">drop_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Drop a column from the DataFrame.</span>

<span class="sd">        :param column_name: The name of the column to drop.</span>
<span class="sd">        :raise NotImplementedError: Indicates the method needs to be implemented in a subclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This is a base class&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">condition</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter rows based on a specified condition.</span>

<span class="sd">        :param condition: The condition to filter rows.</span>
<span class="sd">        :raise NotImplementedError: Indicates the method needs to be implemented in a subclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This is a base class&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the shape of the DataFrame.</span>

<span class="sd">        :return: A tuple representing the shape of the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate descriptive statistics.</span>

<span class="sd">        :return: Descriptive statistics for the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the custom DataFrame to a Pandas DataFrame.</span>

<span class="sd">        :raise NotImplementedError: Indicates the method needs to be implemented in a subclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This is a base class&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_clipboard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copy the DataFrame to the system clipboard.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_clipboard.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_clipboard.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_clipboard method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_clipboard</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_feather</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the DataFrame to a Feather file.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_feather.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_feather.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_feather method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_feather</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the DataFrame to a JSON string.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_json.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_json.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_json method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_orc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the DataFrame to an ORC file.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_orc.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_orc.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_orc method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_orc</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the DataFrame to a NumPy record array.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_records.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_records.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_records method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_records</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cast to DatetimeIndex of timestamps.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_timestamp.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_timestamp.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_timestamp method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the DataFrame to a comma-separated values (csv) file.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_csv.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_csv.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_csv method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_gbq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the DataFrame to a Google BigQuery table.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_gbq.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_gbq.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_gbq method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_gbq</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_latex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Render the DataFrame as a LaTeX tabular environment table.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_latex.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_latex.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_latex method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_parquet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the DataFrame to a Parquet file.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_parquet.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_parquet.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_parquet method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write records stored in the DataFrame to a SQL database.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_sql.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_sql.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_sql method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_xarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the DataFrame to an xarray Dataset.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_xarray.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_xarray.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_xarray method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the DataFrame to a dictionary.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_dict.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_dict.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_dict method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_hdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the DataFrame to a Hierarchical Data Format (HDF) file.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_hdf.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_hdf.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_hdf method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the DataFrame to a Markdown string.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_markdown.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_markdown.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_markdown method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_period</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert DataFrame from DatetimeIndex to PeriodIndex.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_period.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_period.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_period method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_stata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Export the DataFrame to Stata data format.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_stata.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_stata.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_stata method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_stata</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the DataFrame to an XML string.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_xml.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_xml.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_xml method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the DataFrame to an Excel file.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_excel.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_excel.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_excel method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Render the DataFrame as an HTML table.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_html.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_html.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_html method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the DataFrame to a NumPy array.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_numpy.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_numpy.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_numpy method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Render the DataFrame to a console-friendly tabular output.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.to_string.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.to_string.</span>
<span class="sd">        :return: Output of Pandas DataFrame to_string method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">valid_data_types</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">([</span><span class="n">item</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="n">key</span><span class="p">]])</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_pandas</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">colspecs</span> <span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;CustomDataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a CustomDataFrame from a pandas DataFrame.</span>

<span class="sd">        :param df: DataFrame to create from.</span>
<span class="sd">        :param colspecs: dictionary of the column specifications.</span>
<span class="sd">        :return: A CustomDataFrame object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">colspecs</span><span class="p">,</span>
        <span class="p">)</span>
    
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_csv</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read a comma-separated values (csv) file into a CustomDataFrame.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.read_csv.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.read_csv.</span>
<span class="sd">        :return: A CustomDataFrame object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a CustomDataFrame from a dict of array-like or dicts.</span>

<span class="sd">        :param data: Dictionary of data.</span>
<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.from_dict.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.from_dict.</span>
<span class="sd">        :return: A CustomDataFrame object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">to_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the output data to the flows specified in the interface.</span>

<span class="sd">        :param interface: Interface object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interface</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">Interface</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Interface must be a dictionary or of type Interface.&quot;</span><span class="p">)</span>
        <span class="n">data_written</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">details</span> <span class="ow">in</span> <span class="n">interface</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;output&quot;</span><span class="p">]:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">typ</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">write_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                            <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
                        <span class="p">)</span>
                        
                        <span class="n">access</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write_data</span><span class="p">(</span><span class="n">write_df</span><span class="p">,</span> <span class="n">details</span><span class="p">)</span>
                        <span class="n">data_written</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data for type &#39;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="s2">&#39; written successfully.&quot;</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error writing data for type &#39;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data found for type &#39;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="s2">&#39; to write.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_written</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data written, implying no data of type </span><span class="se">\&quot;</span><span class="s2">output</span><span class="se">\&quot;</span><span class="s2"> found, data in CustomDataFrame are </span><span class="se">\&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_from_flow</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">interface</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Compute</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a compute object from an interface object.</span>

<span class="sd">        :param interface: Interface object.</span>
<span class="sd">        :type interface: lynguine.config.interface.Interface or dict.</span>
<span class="sd">        :return: A compute object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interface</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">Interface</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Interface must be a dictionary or of type Interface.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Compute</span><span class="o">.</span><span class="n">from_flow</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_flow</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">interface</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a CustomDataFrame from a interface object.</span>

<span class="sd">        :param interface: Interface object.</span>
<span class="sd">        :type interface: lynguine.config.interface.Interface or dict.</span>
<span class="sd">        :return: A CustomDataFrame object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TODO: For input, convert this to a simple &quot;read_data&quot; operation</span>
        <span class="c1"># and have the merges handled by read_hstack and</span>
        <span class="c1"># read_vstack. Make it illegal to do a read_hstack or</span>
        <span class="c1"># read_vstack if it&#39;s an output.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interface</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">Interface</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Interface must be a dictionary or of type Interface.&quot;</span><span class="p">)</span>
        <span class="n">default_joins</span> <span class="o">=</span> <span class="s2">&quot;outer&quot;</span>
        <span class="n">selector</span> <span class="o">=</span> <span class="kc">None</span>
                
        <span class="c1"># Initialize compute from the interface so it can be used below.</span>
        <span class="n">compute</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">compute_from_flow</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>
        <span class="n">cdf</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">({},</span> <span class="n">compute</span><span class="o">=</span><span class="n">compute</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="n">interface</span><span class="p">)</span>

        <span class="n">found_data</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Create a function to determine the processing order</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">key_order</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">item</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># Process first</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="mi">1</span>  <span class="c1"># Process second</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;output&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="mi">2</span>  <span class="c1"># Process third</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">3</span>  <span class="c1"># Process last</span>

        <span class="c1"># Sort the items based on the key_order function</span>
        <span class="n">sorted_items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">interface</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">key_order</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sorted_items</span><span class="p">:</span>       
            <span class="c1"># Check if the interface key is a valid data key</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">valid_data_types</span><span class="p">:</span> <span class="c1"># input, output, cache, parameters</span>
                <span class="c1"># Augment the item with base_directory if it&#39;s not already present</span>
                <span class="k">if</span> <span class="s2">&quot;base_directory&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;base_directory&quot;</span> <span class="ow">in</span> <span class="n">interface</span><span class="p">:</span>
                        <span class="n">item</span><span class="p">[</span><span class="s2">&quot;base_directory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interface</span><span class="p">[</span><span class="s2">&quot;base_directory&quot;</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>   
                        <span class="n">errmsg</span> <span class="o">=</span> <span class="s2">&quot;Base directory not found in interface or item.&quot;</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding data key </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> to the CustomDataFrame.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="s2">&quot;mapping&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                    <span class="n">mapping</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;mapping&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">mapping</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cdf</span><span class="o">.</span><span class="n">_d</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">cdf</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Attempting to set the </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> portion of the data frame from flow, but have found one already exists. Current keys are </span><span class="se">\&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cdf</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                <span class="n">found_data</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]:</span> <span class="c1"># allow creation of non-inputs if they don&#39;t exist</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">access</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">data_exists</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                            <span class="n">newdf</span> <span class="o">=</span> <span class="n">cdf</span><span class="o">.</span><span class="n">_finalize_df</span><span class="p">(</span><span class="o">*</span><span class="n">access</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data for type &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found, creating new..&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="s2">&quot;columns&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                                <span class="n">columns</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;cache&quot;</span><span class="p">]:</span>
                                    <span class="n">columns</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">get_cache_columns</span><span class="p">()</span>
                                <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;output&quot;</span><span class="p">]:</span>
                                    <span class="n">columns</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">get_output_columns</span><span class="p">()</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                        <span class="sa">f</span><span class="s2">&quot;Unrecognised key type </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">. Valid data types are </span><span class="se">\&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">valid_data_types</span><span class="p">)</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
                                    <span class="p">)</span>
                            <span class="n">newdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">cdf</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
                            
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Item data descriptions must be in the form of a dictionary unless they are of type </span><span class="se">\&quot;</span><span class="s2">input</span><span class="se">\&quot;</span><span class="s2">, when a list is valid and implies an </span><span class="se">\&quot;</span><span class="s2">hstack</span><span class="se">\&quot;</span><span class="s2"> type is needed. The type of item you have provided for the key </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is </span><span class="se">\&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
                        <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">newdf</span> <span class="o">=</span> <span class="n">cdf</span><span class="o">.</span><span class="n">_finalize_df</span><span class="p">(</span><span class="o">*</span><span class="n">access</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="n">item</span><span class="p">),</span> <span class="n">strict_columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding parameter type with key </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
                    <span class="c1"># If select is listed choose only the row of the data frame.</span>
                    <span class="k">if</span> <span class="s2">&quot;select&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                        <span class="c1"># Select the data from the dataframe.</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selecting item with index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;select&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> for the parameter type </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
                        <span class="n">newds</span> <span class="o">=</span> <span class="n">newdf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;select&quot;</span><span class="p">]]</span>
                        <span class="n">newdf</span> <span class="o">=</span> <span class="n">newds</span> 

                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                    <span class="c1"># Remove duplicates in newdf index</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">newdf</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
                        <span class="c1"># Extract the names of duplicate rows.</span>
                        <span class="n">duplicates</span> <span class="o">=</span> <span class="n">newdf</span><span class="p">[</span><span class="n">newdf</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)]</span>
                        <span class="n">duplicate_names</span> <span class="o">=</span> <span class="n">duplicates</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Duplicate index values found in the data frame for key </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">. Duplicates are </span><span class="se">\&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">duplicate_names</span><span class="p">)</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">. Removing duplicates.&quot;</span><span class="p">)</span>
                        <span class="n">newdf</span> <span class="o">=</span> <span class="n">newdf</span><span class="p">[</span><span class="o">~</span><span class="n">newdf</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)]</span>
                        
                <span class="k">if</span> <span class="n">cdf</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating new CustomDataFrame in from_flow from key </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
                    <span class="n">compute</span> <span class="o">=</span> <span class="n">cdf</span><span class="o">.</span><span class="n">compute</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">newdf</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                        <span class="n">cdf</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
                            <span class="n">data</span><span class="o">=</span><span class="n">newdf</span><span class="p">,</span>
                            <span class="n">colspecs</span><span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">newdf</span><span class="o">.</span><span class="n">columns</span><span class="p">)},</span>
                            <span class="n">selector</span><span class="o">=</span><span class="n">selector</span><span class="p">,</span>
                            <span class="n">interface</span><span class="o">=</span><span class="n">interface</span>
                        <span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">newdf</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                        <span class="n">cdf</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
                            <span class="n">data</span><span class="o">=</span><span class="n">newdf</span><span class="p">,</span>
                            <span class="n">colspecs</span><span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">newdf</span><span class="o">.</span><span class="n">index</span><span class="p">)},</span>
                            <span class="n">selector</span><span class="o">=</span><span class="n">selector</span><span class="p">,</span>
                            <span class="n">interface</span><span class="o">=</span><span class="n">interface</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Something has gone wrong, the data type of the new data frame is </span><span class="se">\&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">newdf</span><span class="p">)</span><span class="si">}</span><span class="s2"> whereas we expect either pd.DataFrame or pd.Series</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                    
                    <span class="n">cdf</span><span class="o">.</span><span class="n">compute</span> <span class="o">=</span> <span class="n">compute</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding key </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> to CustomDataFrame.&quot;</span><span class="p">)</span>
                    <span class="n">cdf</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">newdf</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">newdf</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                        <span class="n">cdf</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">newdf</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">newdf</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                        <span class="n">cdf</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">newdf</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mapping</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">mapping</span> <span class="o">=</span> <span class="p">[</span><span class="n">mapping</span><span class="p">]</span>
                               
                <span class="k">for</span> <span class="n">mapp</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">mapp</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">cdf</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                            <span class="n">cdf</span><span class="o">.</span><span class="n">update_name_column_map</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
                <span class="n">cdf</span><span class="o">.</span><span class="n">_augment_column_names</span><span class="p">(</span><span class="n">cdf</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                
        <span class="k">if</span> <span class="ow">not</span> <span class="n">found_data</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;No valid data found in interface. Data fields must be one of &quot;</span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">valid_data_types</span><span class="p">)</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cdf</span><span class="o">.</span><span class="n">interface</span> <span class="o">=</span> <span class="n">interface</span>

        <span class="k">if</span> <span class="s2">&quot;series&quot;</span> <span class="ow">in</span> <span class="n">interface</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;selector&quot;</span> <span class="ow">in</span> <span class="n">interface</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]:</span>
                <span class="n">cdf</span><span class="o">.</span><span class="n">set_selector</span><span class="p">(</span><span class="n">interface</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">][</span><span class="s2">&quot;selector&quot;</span><span class="p">])</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting selector to </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">selector</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> for series type.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cdf</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_new_data_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span> <span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">key</span> <span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new data frame from an interface specification.</span>

<span class="sd">        :param item: The interface to create the data frame from.</span>
<span class="sd">        :type item:  lynguine.config.interface.Interface or dict.</span>
<span class="sd">        :return: a pd.DataFrame object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;columns&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;cache&quot;</span><span class="p">]:</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_cache_columns</span><span class="p">()</span>
            <span class="c1"># TK Need to deal with series here?</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;output&quot;</span><span class="p">]:</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_output_columns</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unrecognised key type </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">. Valid data types are </span><span class="se">\&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">valid_data_types</span><span class="p">)</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
                                    <span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">augment_with_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">colspecs</span> <span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method is used to augment the CustomDataFrame with a new DataFrame.</span>

<span class="sd">        :param df: The DataFrame to augment with.</span>
<span class="sd">        :param colspecs: The colspecs to use.</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Ensure none of these columns are present already.</span>
        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">colspecs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> was provided to augment the CustomDataFrame but already exists in the CustomDataFrame.&quot;</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                
        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">colspecs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                <span class="c1"># Check each element in each column is identical</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                        <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> in </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is specified as a parameters type but the rows of the the column are not identical.&quot;</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                    
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">cols</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>    
                <span class="k">else</span><span class="p">:</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">cols</span>
            <span class="k">else</span><span class="p">:</span>   
                <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span> <span class="c1"># parameters type</span>
                        <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;The data type of the </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> portion of the data frame is </span><span class="se">\&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">])</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> whereas we expect a pd.Series. as it&#39;s representing parameters.&quot;</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                    <span class="n">sds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">cols</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="c1"># Concatenate the series</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">],</span> <span class="n">sds</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]:</span>
                    <span class="n">sdf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">],</span> <span class="n">sdf</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sdf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">sdf</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">],</span> <span class="n">sdf</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span> 
                        <span class="c1"># Check if elements with the same index are identical</span>
                        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">sdf</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">row</span> <span class="o">==</span> <span class="n">sdf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">]):</span>
                                <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> in </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is specified as a parameters type but the rows of the the column are not identical.&quot;</span>
                                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                        <span class="c1"># Resolve duplicates</span>
                        <span class="n">sdf</span> <span class="o">=</span> <span class="n">sdf</span><span class="p">[</span><span class="o">~</span><span class="n">sdf</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">],</span> <span class="n">sdf</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                
                    
                <span class="c1"># Update the current list of columns with cols.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cols</span>

        
    <span class="k">def</span><span class="w"> </span><span class="nf">save_flows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the output flows.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;output&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span>
                <span class="n">write_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
                <span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving data for flow type &#39;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
                <span class="n">access</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write_data</span><span class="p">(</span><span class="n">write_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">[</span><span class="n">typ</span><span class="p">])</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">sort_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sort by the values along either axis.</span>

<span class="sd">        :param by: str or list of str</span>
<span class="sd">        :param axis: {0 or &#39;index&#39;, 1 or &#39;columns&#39;}, default 0</span>
<span class="sd">        :param ascending: bool or list of bool, default True</span>
<span class="sd">        :param inplace: bool, default False</span>
<span class="sd">        :param kind: {&#39;quicksort&#39;, &#39;mergesort&#39;, &#39;heapsort&#39;}, default &#39;quicksort&#39;</span>
<span class="sd">        :param na_position: {&#39;first&#39;, &#39;last&#39;}, default &#39;last&#39;</span>
<span class="sd">        :param ignore_index: bool, default False</span>
<span class="sd">        :param key: callable, optional</span>
<span class="sd">        :return: sorted_obj : CustomDataFrame</span>
<span class="sd">        :raises ValueError: If any of the keys are not in the index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_distribute_data</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
                <span class="n">df</span><span class="p">,</span>
                <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colspecs</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
                <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
                <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sort_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sort object by labels (along an axis).</span>

<span class="sd">        :param axis: {0 or &#39;index&#39;, 1 or &#39;columns&#39;}, default 0</span>
<span class="sd">        :param level: int or level name or list of ints or list of level names</span>
<span class="sd">        :param ascending: bool or list of bool, default True</span>
<span class="sd">        :param inplace: bool, default False</span>
<span class="sd">        :param kind: {&#39;quicksort&#39;, &#39;mergesort&#39;, &#39;heapsort&#39;}, default &#39;quicksort&#39;</span>
<span class="sd">        :param na_position: {&#39;first&#39;, &#39;last&#39;}, default &#39;last&#39;</span>
<span class="sd">        :param sort_remaining: bool, default True</span>
<span class="sd">        :param ignore_index: bool, default False</span>
<span class="sd">        :param key: callable, optional.</span>
<span class="sd">        :return: sorted_obj : CustomDataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_distribute_data</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
                <span class="n">df</span><span class="p">,</span>
                <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colspecs</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
                <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
                <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert various data types to a CustomDataFrame.</span>

<span class="sd">        This method handles conversion from different data types like Pandas DataFrame,</span>
<span class="sd">        Pandas Series, NumPy array, list, and dictionary to the CustomDataFrame format.</span>

<span class="sd">        :param other: The data to be converted.</span>
<span class="sd">        :return: A CustomDataFrame object.</span>
<span class="sd">        :raises ValueError: If the data type of `other` cannot be converted.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="c1"># No conversion needed if it&#39;s already a CustomDataFrame</span>
            <span class="k">return</span> <span class="n">other</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
            <span class="c1"># Directly convert from Pandas DataFrame or Series</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="c1"># Handle NumPy array conversion</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_numpy_array</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="c1"># Convert list to CustomDataFrame</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_convert_numpy_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># Convert dictionary to CustomDataFrame</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Raise error for unsupported types</span>
            <span class="k">return</span> <span class="n">other</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_numpy_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method to convert a NumPy array to a CustomDataFrame.</span>

<span class="sd">        This method is called internally to handle specific scenarios based on the shape</span>
<span class="sd">        of the NumPy array.</span>

<span class="sd">        :param array: The NumPy array to be converted.</span>
<span class="sd">        :return: A CustomDataFrame object.</span>
<span class="sd">        :raises ValueError: If the array shape is not compatible.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="c1"># Array shape matches the CustomDataFrame shape</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Single dimensional array (e.g. [1, 2, 3])</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">()]),</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Two-dimensional array but with a single row (e.g. [[1, 2, 3]])</span>
            <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;NumPy array width doesn&#39;t match CustomDataFrame array width.&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                    <span class="n">array</span><span class="p">,</span>
                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">()],</span>
                    <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Two-dimensional array but with a single column (e.g. [[1], [2], [3]])</span>
            <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;NumPy array depth doesn&#39;t match CustomDataFrame array depth.&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                    <span class="n">array</span><span class="p">,</span>
                    <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                    <span class="n">columns</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">()]),</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Incompatible array shape</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;NumPy array shape is not compatible with CustomDataFrame.&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Mathematical operations</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">()</span>
            <span class="n">colspecs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;parameter_cache&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span>
            <span class="n">colspecs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;parameter_cache&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="n">colspecs</span><span class="p">,</span>
            <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">()</span>
            <span class="n">colspecs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;parameter_cache&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span>
            <span class="n">colspecs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;parameter_cache&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="n">colspecs</span><span class="p">,</span>
            <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">subtract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">multiply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()),</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">equals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="s2">&quot;cache&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()),</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="s2">&quot;cache&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">isna</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">isnull</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">notna</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fillna</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dropna</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vals</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vals</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">sel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">vals</span><span class="p">,</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span>
            <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
            <span class="n">selector</span><span class="o">=</span><span class="n">sel</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">drop_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vals</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">vals</span><span class="p">,</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Group DataFrame using a mapper or by a Series of columns.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.groupby.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.groupby.</span>
<span class="sd">        :return: A pd.DataFrameGroupBy object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pivot_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a pivot table as a CustomDataFrame.</span>

<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.pivot_table.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.pivot_table.</span>
<span class="sd">        :return: A pivoted CustomDataFrame object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply a specified operator to the DataFrame.</span>

<span class="sd">        :param other: The right-hand operand.</span>
<span class="sd">        :param operator: The operator function to apply.</span>
<span class="sd">        :return: A new instance of CustomDataFrame after applying the operator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">operator</span><span class="p">)</span>

        <span class="c1"># deal with pandas translation of single row on right to a series.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">CustomDataFrame</span><span class="p">):</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">other</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">method</span><span class="p">(</span><span class="n">right</span><span class="p">),</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dtypes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Property to return the data types of the columns across all sub-DataFrames.</span>
<span class="sd">        :return: A Series containing the data types of the columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_dtypes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">df_name</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">df_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                <span class="c1"># the data should be a series</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="n">all_dtypes</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dtype</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="n">all_dtypes</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">all_dtypes</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access the system log.</span>

<span class="sd">        :return: Reference to the system log.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log</span>

    <span class="nd">@log</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the system log.</span>

<span class="sd">        :param value: The new system log.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="o">=</span> <span class="n">value</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">T</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transpose the DataFrame.</span>

<span class="sd">        :return: Transposed CustomDataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the shape of the DataFrame.</span>

<span class="sd">        :return: A tuple representing the DataFrame&#39;s dimensions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the column labels of the DataFrame.</span>

<span class="sd">        :return: Index object containing the column labels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                <span class="n">columns</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">columns</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the index (row labels) of the DataFrame.</span>

<span class="sd">        :return: Index object containing the row labels.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Take index from first entry in _d that is not a &quot;parameters&quot; entry</span>
        <span class="c1"># Note that if first entry is a &quot;series&quot; entry, then index will likely be duplicated</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">typ</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span>

        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;output&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">typ</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">typ</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span>

        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;cache&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">typ</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">typ</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span>

        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;output&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;cache&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([])</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return True if DataFrame is empty.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">empty</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the values of the DataFrame as a NumPy array.</span>

<span class="sd">        :return: A NumPy array of the DataFrame&#39;s values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">colspecs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the column specifications.</span>

<span class="sd">        :return: Column specifications.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span>

    <span class="nd">@colspecs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">colspecs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the column specifications.</span>

<span class="sd">        :param value: New column specifications.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_data_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the data dictionary.</span>

<span class="sd">        :return: Data dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span>
    
    <span class="c1"># Operators</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the number of rows in the CustomDataFrame.</span>

<span class="sd">        Overriding the __len__ method allows the use of the len() function</span>
<span class="sd">        on the CustomDataFrame, similar to how len() is used with Pandas DataFrame.</span>
<span class="sd">        It returns the number of rows in the DataFrame.</span>

<span class="sd">        :return: The number of rows in the CustomDataFrame.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Because we don&#39;t return series, length should be the non-singleton dimension.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the addition (&#39;+&#39;) operator.</span>

<span class="sd">        :param other: The right-hand operand for addition.</span>
<span class="sd">        :return: The result of adding the CustomDataFrame and other.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the subtraction (&#39;-&#39;) operator.</span>

<span class="sd">        :param other: The right-hand operand for subtraction.</span>
<span class="sd">        :return: The result of subtracting other from the CustomDataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the multiplication (&#39;*&#39;) operator.</span>

<span class="sd">        :param other: The right-hand operand for multiplication.</span>
<span class="sd">        :return: The result of multiplying the CustomDataFrame and other.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the bitwise NOT (&#39;~&#39;) operator.</span>

<span class="sd">        :return: The result of bitwise NOT of the CustomDataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=~</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the unary negation (&#39;-&#39;) operator.</span>

<span class="sd">        :return: The result of negating the CustomDataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the true division (&#39;/&#39;) operator.</span>

<span class="sd">        :param other: The right-hand operand for division.</span>
<span class="sd">        :return: The result of true division of the CustomDataFrame by other.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the floor division (&#39;//&#39;) operator.</span>

<span class="sd">        :param other: The right-hand operand for floor division.</span>
<span class="sd">        :return: A new instance of CustomDataFrame after floor division.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span> <span class="o">//</span> <span class="n">other</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__matmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the matrix multiplication (&#39;@&#39;) operator.</span>

<span class="sd">        :param other: The right-hand operand for matrix multiplication.</span>
<span class="sd">        :return: The result of the matrix multiplication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exponent</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the power (&#39;**&#39;) operator.</span>

<span class="sd">        :param exponent: The exponent to raise the dataframe to.</span>
<span class="sd">        :return: A new instance of CustomDataFrame after raising to the power.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span> <span class="o">**</span> <span class="n">exponent</span><span class="p">,</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the equality (&#39;==&#39;) operator.</span>

<span class="sd">        :param other: The right-hand operand for comparison.</span>
<span class="sd">        :return: The result of the equality comparison.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_operator</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;__eq__&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the greater than (&#39;&gt;&#39;) operator.</span>

<span class="sd">        :param other: The right-hand operand for comparison.</span>
<span class="sd">        :return: The result of the greater than comparison.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_operator</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;__gt__&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the less than (&#39;&lt;&#39;) operator.</span>

<span class="sd">        :param other: The right-hand operand for comparison.</span>
<span class="sd">        :return: The result of the less than comparison.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_operator</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;__lt__&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the greater than or equal to (&#39;&gt;=&#39;) operator.</span>

<span class="sd">        :param other: The right-hand operand for comparison.</span>
<span class="sd">        :return: The result of the greater than or equal to comparison.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_operator</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;__ge__&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the less than or equal to (&#39;&lt;=&#39;) operator.</span>

<span class="sd">        :param other: The right-hand operand for comparison.</span>
<span class="sd">        :return: The result of the less than or equal to comparison.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_operator</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;__le__&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload the not equal (&#39;!=&#39;) operator.</span>

<span class="sd">        :param other: The right-hand operand for comparison.</span>
<span class="sd">        :return: The result of the not equal comparison.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_operator</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;__ne__&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__array__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the CustomDataFrame to a NumPy array.</span>

<span class="sd">        :param dtype: The desired data-type for the array.</span>
<span class="sd">        :return: A NumPy array representation of the CustomDataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get item or slice from the DataFrame.</span>

<span class="sd">        :param key: The key or slice to access elements of the DataFrame.</span>
<span class="sd">        :retugrn: A subset of the DataFrame corresponding to the given key.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">CustomDataFrame</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()[</span><span class="n">key</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colspecs</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">[</span><span class="n">spec</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">colspecs</span><span class="p">:</span>
                            <span class="n">colspecs</span><span class="p">[</span><span class="n">spec</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">colspecs</span><span class="p">[</span><span class="n">spec</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">colspecs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cache&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                <span class="n">colspecs</span><span class="o">=</span><span class="n">colspecs</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set item in the CustomDataFrame.</span>

<span class="sd">        :param key: The key or slice to access elements of the DataFrame.</span>
<span class="sd">        :param value: The value to assign to the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;__getitem__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Check if key refers to a single column or more than one</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_series_columns</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
                    <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error: Index is not unique for value assigned to column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> and </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is not a </span><span class="se">\&quot;</span><span class="s2">series</span><span class="se">\&quot;</span><span class="s2"> type.&quot;</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column_type</span><span class="p">(</span><span class="n">key</span><span class="p">)][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;cacheseries&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">[</span><span class="s2">&quot;cacheseries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="s2">&quot;cacheseries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="s2">&quot;cacheseries&quot;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>                    
                        
                    <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">[</span><span class="s2">&quot;cacheseries&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;cache&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">[</span><span class="s2">&quot;cache&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="s2">&quot;cache&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="p">[</span><span class="s2">&quot;cache&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="s2">&quot;cache&quot;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">column</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_colspecs_after_merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">merged_df</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">suffixes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update colspecs after a merge operation to reflect changes in column names.</span>

<span class="sd">        :param left: The left DataFrame used in the merge.</span>
<span class="sd">        :param right: The right DataFrame used in the merge.</span>
<span class="sd">        :param merged_df: The resulting merged DataFrame.</span>
<span class="sd">        :param on: Columns used for merging.</span>
<span class="sd">        :param suffixes: Suffixes used in the merge to resolve overlapping column names.</span>
<span class="sd">        :return: Updated colspecs dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">on</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">on</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Initialize updated colspecs</span>
        <span class="n">updated_colspecs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">colspecs</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

        <span class="c1"># Add right DataFrame&#39;s colspecs, preferring left in case of overlap</span>
        <span class="k">for</span> <span class="n">ctype</span><span class="p">,</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">right</span><span class="o">.</span><span class="n">colspecs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">ctype</span> <span class="ow">in</span> <span class="n">updated_colspecs</span><span class="p">:</span>
                <span class="n">updated_colspecs</span><span class="p">[</span><span class="n">ctype</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">on</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">updated_colspecs</span><span class="p">[</span><span class="n">ctype</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">on</span><span class="p">]</span>

        <span class="c1"># Adjust column names for suffixes and merge keys</span>
        <span class="n">left_suffix</span><span class="p">,</span> <span class="n">right_suffix</span> <span class="o">=</span> <span class="n">suffixes</span>
        <span class="n">allocated</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ctype</span><span class="p">,</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">updated_colspecs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">updated</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
                    <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">on</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="n">left_suffix</span><span class="p">)</span> <span class="ow">in</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">columns</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="n">left_suffix</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allocated</span>
                <span class="p">):</span>
                    <span class="n">updated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="n">left_suffix</span><span class="p">)</span>
                    <span class="n">allocated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="n">left_suffix</span><span class="p">)</span>
                <span class="k">elif</span> <span class="p">(</span>
                    <span class="n">col</span> <span class="ow">in</span> <span class="n">right</span><span class="o">.</span><span class="n">columns</span>
                    <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">on</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="n">right_suffix</span><span class="p">)</span> <span class="ow">in</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">columns</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="n">right_suffix</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allocated</span>
                <span class="p">):</span>
                    <span class="n">updated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="n">right_suffix</span><span class="p">)</span>
                    <span class="n">allocated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="n">right_suffix</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">updated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
                    <span class="n">allocated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="n">updated_colspecs</span><span class="p">[</span><span class="n">ctype</span><span class="p">]</span> <span class="o">=</span> <span class="n">updated</span>

        <span class="c1"># Remove any columns that are not in the merged DataFrame</span>
        <span class="k">for</span> <span class="n">ctype</span> <span class="ow">in</span> <span class="n">updated_colspecs</span><span class="p">:</span>
            <span class="n">updated_colspecs</span><span class="p">[</span><span class="n">ctype</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">updated_colspecs</span><span class="p">[</span><span class="n">ctype</span><span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">columns</span>
            <span class="p">]</span>

        <span class="k">return</span> <span class="n">updated_colspecs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">result_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply a function along an axis of the DataFrame.</span>

<span class="sd">        :param func: Function to apply to each column or row.</span>
<span class="sd">        :param axis: Axis along which the function is applied.</span>
<span class="sd">                     0 or &#39;index&#39;: apply function to each column.</span>
<span class="sd">                     1 or &#39;columns&#39;: apply function to each row.</span>
<span class="sd">        :param raw: Determines if row/column labels are passed to the function.</span>
<span class="sd">        :param result_type: Type of the return value. Can be &#39;expand&#39;, &#39;reduce&#39;, or None.</span>
<span class="sd">        :param args: Additional positional arguments to pass to func.</span>
<span class="sd">        :param kwargs: Additional keyword arguments to pass to func.</span>
<span class="sd">        :return: A new CustomDataFrame with the results of the applied function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Convert to pandas DataFrame</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>

        <span class="c1"># Apply the function</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">,</span> <span class="n">result_type</span><span class="o">=</span><span class="n">result_type</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># If the result is a Series, convert it to a DataFrame</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>

        <span class="c1"># Create a new CustomDataFrame from the result</span>
        <span class="n">new_colspecs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_colspecs_after_apply</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">result</span><span class="p">,</span>
            <span class="n">colspecs</span><span class="o">=</span><span class="n">new_colspecs</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(),</span>
            <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(),</span>
            <span class="n">selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_colspecs_after_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update colspecs after applying a function.</span>

<span class="sd">        :param result: The DataFrame resulting from the apply operation.</span>
<span class="sd">        :return: Updated colspecs dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_colspecs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">cols</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">colspecs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">new_cols</span><span class="p">:</span>
                <span class="n">new_colspecs</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_cols</span>

        <span class="c1"># Add any new columns to &#39;cache&#39; type</span>
        <span class="n">new_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;cache&#39;</span> <span class="ow">in</span> <span class="n">new_colspecs</span><span class="p">:</span>
                <span class="n">new_colspecs</span><span class="p">[</span><span class="s1">&#39;cache&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">new_columns</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_colspecs</span><span class="p">[</span><span class="s1">&#39;cache&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_columns</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_colspecs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">right</span><span class="p">,</span>
        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span>
        <span class="n">on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">left_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">right_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merge CustomDataFrame with another DataFrame or CustomDataFrame.</span>

<span class="sd">        :param right: Another DataFrame or CustomDataFrame to merge with.</span>
<span class="sd">        :param how, on, left_on, right_on, args, kwargs: Parameters for pandas.DataFrame.merge.</span>
<span class="sd">        :param suffixes: A tuple of string suffixes to apply to overlapping column names.</span>
<span class="sd">        :return: A new CustomDataFrame resulting from the merge operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Perform the merge operation</span>
        <span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span>
            <span class="n">right</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">CustomDataFrame</span><span class="p">)</span> <span class="k">else</span> <span class="n">right</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">,</span>
            <span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span>
            <span class="n">left_on</span><span class="o">=</span><span class="n">left_on</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="n">right_on</span><span class="p">,</span>
            <span class="n">suffixes</span><span class="o">=</span><span class="n">suffixes</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Update colspecs</span>
        <span class="n">colspecs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_colspecs_after_merge</span><span class="p">(</span>
            <span class="n">right</span><span class="p">,</span> <span class="n">merged_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="n">suffixes</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">merged_df</span><span class="p">,</span> <span class="n">colspecs</span><span class="o">=</span><span class="n">colspecs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="n">on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="n">lsuffix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Join CustomDataFrame with another DataFrame or CustomDataFrame.</span>

<span class="sd">        :param other: Another DataFrame or CustomDataFrame to merge with.</span>
<span class="sd">        :param on: Columns to join on.</span>
<span class="sd">        :type on: str, list, or array-like</span>
<span class="sd">        :param how: How to join the DataFrames.</span>
<span class="sd">        :type how: str</span>
<span class="sd">        :param lsuffix: Suffix to apply to overlapping column names from the left DataFrame.</span>
<span class="sd">        :type lsuffix: str</span>
<span class="sd">        :param rsuffix: Suffix to apply to overlapping column names from the right DataFrame.</span>
<span class="sd">        :type rsuffix: str</span>
<span class="sd">        :param sort: Sort the join keys lexicographically in the result DataFrame.</span>
<span class="sd">        :type sort: bool</span>
<span class="sd">        :param args: Positional arguments to be passed to pandas.DataFrame.join.</span>
<span class="sd">        :param kwargs: Keyword arguments to be passed to pandas.DataFrame.join.</span>
<span class="sd">        :return: A new CustomDataFrame resulting from the join operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Perform the join operation</span>
        <span class="n">join_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">CustomDataFrame</span><span class="p">)</span> <span class="k">else</span> <span class="n">other</span><span class="p">,</span>
            <span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">,</span>
            <span class="n">lsuffix</span><span class="o">=</span><span class="n">lsuffix</span><span class="p">,</span>
            <span class="n">rsuffix</span><span class="o">=</span><span class="n">rsuffix</span><span class="p">,</span>
            <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">,</span>
            <span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Update colspecs</span>
        <span class="n">colspecs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_colspecs_after_merge</span><span class="p">(</span>
            <span class="n">other</span><span class="p">,</span> <span class="n">join_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="n">lsuffix</span><span class="p">,</span> <span class="n">rsuffix</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">join_df</span><span class="p">,</span> <span class="n">colspecs</span><span class="o">=</span><span class="n">colspecs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span> <span class="p">:</span> <span class="n">Interface</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Compute</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract the compute object.</span>

<span class="sd">        :param interface: The interface to the compute object.</span>
<span class="sd">        :type interface: lynguine.config.interface.Interface or dict</span>
<span class="sd">        :returns: The compute object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This is a base class&quot;</span><span class="p">)</span>
                            
    <span class="k">def</span><span class="w"> </span><span class="nf">_finalize_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">interface</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is used to attend to any modifications in the details dict to finalize the data frame. It fixes up the index, adds columns, sets the right data type etc.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This is a base class&quot;</span><span class="p">)</span>
    
<span class="k">class</span><span class="w"> </span><span class="nc">CustomDataFrame</span><span class="p">(</span><span class="n">DataObject</span><span class="p">):</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># Input types are standard DataFrames but are not mutable.</span>
        <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;input&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data&quot;</span><span class="p">,</span>
            <span class="s2">&quot;constants&quot;</span><span class="p">,</span>
            <span class="s2">&quot;global_consts&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="c1"># Output types are standard DataFrames that are mutable and</span>
        <span class="c1"># intended to be recorded once operations on the</span>
        <span class="c1"># CustomDataFrame are complete.</span>
        <span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;output&quot;</span><span class="p">,</span>
            <span class="s2">&quot;series&quot;</span><span class="p">,</span>
            <span class="s2">&quot;writedata&quot;</span><span class="p">,</span>
            <span class="s2">&quot;writeseries&quot;</span><span class="p">,</span>
            <span class="s2">&quot;parameters&quot;</span><span class="p">,</span>
            <span class="s2">&quot;globals&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="c1"># Parameter types do not have an index, they are globally valid.</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;constants&quot;</span><span class="p">,</span>
            <span class="s2">&quot;global_consts&quot;</span><span class="p">,</span>
            <span class="s2">&quot;parameters&quot;</span><span class="p">,</span>
            <span class="s2">&quot;globals&quot;</span><span class="p">,</span>
            <span class="s2">&quot;parameter_cache&quot;</span><span class="p">,</span>
            <span class="s2">&quot;global_cache&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="c1"># Cache types are standard DataFrames that are mutable and</span>
        <span class="c1"># intended to be used for intermediate calculations.</span>
        <span class="s2">&quot;cache&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;cache&quot;</span><span class="p">,</span>
            <span class="s2">&quot;series_cache&quot;</span><span class="p">,</span>
            <span class="s2">&quot;parameter_cache&quot;</span><span class="p">,</span>
            <span class="s2">&quot;global_cache&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="c1"># Series types are standard DataFrames that are mutable and</span>
        <span class="c1"># may have multiple rows with the same index.</span>
        <span class="s2">&quot;series&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;series&quot;</span><span class="p">,</span>
            <span class="s2">&quot;writeseries&quot;</span><span class="p">,</span>
            <span class="s2">&quot;series_cache&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">}</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">colspecs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subindex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Check if compute is an Interface or a dictionary.</span>
        <span class="k">if</span> <span class="n">compute</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute</span> <span class="o">=</span> <span class="n">Compute</span><span class="p">({})</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">compute</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">compute</span><span class="p">,</span> <span class="n">Interface</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_compute</span><span class="p">(</span><span class="n">compute</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">compute</span><span class="p">,</span> <span class="n">Compute</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute</span> <span class="o">=</span> <span class="n">compute</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;compute must be an Interface, dict, or Compute object.&quot;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Check that dictionary has contents.</span>
                <span class="c1"># Check if all entries are scalar.</span>
                <span class="n">entries</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">complex</span><span class="p">))</span>
                        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span>
                    <span class="p">]</span>
                <span class="p">):</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
                <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span>
                        <span class="p">[</span>
                        <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">))</span>
                        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span>
                    <span class="p">]</span>
                <span class="p">):</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    
            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_name_column_map</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_column_name_map</span> <span class="o">=</span> <span class="p">{}</span>


        <span class="c1"># If the colspecs isn&#39;t specified assume it&#39;s of &quot;cache&quot; type.</span>
        <span class="k">if</span> <span class="n">colspecs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Check if index has duplicates</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Index has duplicates, please specify </span><span class="se">\&quot;</span><span class="s2">colspecs</span><span class="se">\&quot;</span><span class="s2"> to share which columns are to be treated as </span><span class="se">\&quot;</span><span class="s2">series</span><span class="se">\&quot;</span><span class="s2"> types..&quot;</span><span class="p">)</span>
            <span class="c1"># Otherwise assume everything is cache.</span>
            <span class="n">colspecs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cache&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colspecs</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># Check if colspecs is in any of the types dictionary&#39;s entries.</span>
            <span class="n">all_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">typ</span> <span class="k">for</span> <span class="n">typs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="n">typs</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">colspecs</span> <span class="ow">in</span> <span class="n">all_types</span><span class="p">:</span>
                <span class="n">colspecs</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">colspecs</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Column specification &quot;</span><span class="si">{colspecs}</span><span class="s1">&quot; not found in types.&#39;</span>
                <span class="p">)</span>

        <span class="c1"># Add unspecified columns to cache</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">colspecs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">]</span>
        <span class="n">cache</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cache</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;cache&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">colspecs</span><span class="p">:</span>
                <span class="n">colspecs</span><span class="p">[</span><span class="s2">&quot;cache&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">colspecs</span><span class="p">[</span><span class="s2">&quot;cache&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cache</span>

        <span class="c1"># Set up the data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colspecs</span> <span class="o">=</span> <span class="n">colspecs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_distribute_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">autocache</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">interface</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interface</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interface</span> <span class="o">=</span> <span class="n">interface</span>
        <span class="c1"># Set index if not specified</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>                 
                <span class="n">index</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index is not specified in initialisation, setting to </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> which is first entry in indices.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Provided index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is not in index list of CustomDataFrame&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">index</span>

        <span class="c1"># Set column if not specified</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>       
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column is not specified in initialisation, setting to </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> which is first entry in columns.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Provided column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is not in list of CustomDataFrame columns.&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_column</span> <span class="o">=</span> <span class="n">column</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span> <span class="o">=</span> <span class="n">selector</span>
        <span class="c1"># Set selector if not specified</span>
        <span class="k">if</span> <span class="n">selector</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selectors</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">selector</span> <span class="o">=</span> <span class="n">selectors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selector is not specified in initialisation, setting to </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">selector</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> which is first entry in valid selectors.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">selector</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selectors</span><span class="p">():</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Provided selector &#39;</span><span class="si">{</span><span class="n">selector</span><span class="si">}</span><span class="s2">&#39; not found in valid selectors of CustomDataFrame. Valid selectors are </span><span class="se">\&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selectors</span><span class="p">())</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span> <span class="o">=</span> <span class="n">selector</span>
            

        <span class="c1"># Set subindex if not specified</span>
        <span class="k">if</span> <span class="n">subindex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subindices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subindices</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">subindices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">subindex</span> <span class="o">=</span> <span class="n">subindices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subindex is not specified in initialisation, setting to </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">subindex</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> which is first entry in selector&#39;s subindices.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subindex</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subindices</span><span class="p">():</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Provided subindex &#39;</span><span class="si">{</span><span class="n">subindex</span><span class="si">}</span><span class="s2">&#39; not found in </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_selector</span><span class="p">()</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> column of CustomDataFrame for given index </span><span class="se">\&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subindex</span> <span class="o">=</span> <span class="n">subindex</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">at</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_AtAccessor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_LocAccessor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ILocAccessor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="CustomDataFrame.get_type_columns">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_type_columns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_type_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the columns in the CustomDataFrame that are of a specified type.</span>

<span class="sd">        :param col_type: The type of columns to return.</span>
<span class="sd">        :return: A list of columns of the specified type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">col</span>
            <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="n">col_type</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">colspecs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">typ</span><span class="p">,</span> <span class="p">[])</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="CustomDataFrame.get_input_columns">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_input_columns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_input_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the columns in the CustomDataFrame that are immutable.</span>

<span class="sd">        :return: A list of immutable (input) columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_columns</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="CustomDataFrame.get_series_columns">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_series_columns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_series_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the columns in the CustomDataFrame that are of type &quot;series&quot;.</span>

<span class="sd">        :return: A list of series columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_columns</span><span class="p">(</span><span class="s2">&quot;series&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="CustomDataFrame.get_parameters_columns">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_parameters_columns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_parameters_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the columns in the CustomDataFrame that are of type &quot;parameters&quot;.</span>

<span class="sd">        :return: A list of parameters columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_columns</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="CustomDataFrame.get_output_columns">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_output_columns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_output_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the columns in the CustomDataFrame that are of type &quot;output&quot;.</span>

<span class="sd">        :return: A list of output columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_columns</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="CustomDataFrame.get_column_type">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.get_column_type">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_column_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the type of a given column.</span>

<span class="sd">        :return: Column type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">typ</span>
        <span class="k">return</span> <span class="kc">None</span></div>

    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">colspecs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the column specifications.</span>

<span class="sd">        :return: Column specifications.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span>

    <span class="nd">@colspecs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">colspecs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the column specifications.</span>

<span class="sd">        :param value: New column specifications.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span> <span class="o">=</span> <span class="n">value</span>

<div class="viewcode-block" id="CustomDataFrame.coltype">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.coltype">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">coltype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the type of the column.</span>

<span class="sd">        :param col: The column name.</span>
<span class="sd">        :return: The type of the column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">cols</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">colspecs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">typ</span>
        <span class="k">return</span> <span class="kc">None</span></div>

        
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the compute object.</span>

<span class="sd">        :return: The compute object.</span>
<span class="sd">        :rtype: Compute</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute</span>

    <span class="nd">@compute</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the compute object.</span>

<span class="sd">        :param value: The compute object.</span>
<span class="sd">        :type value: Compute</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_compute</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="k">class</span><span class="w"> </span><span class="nc">_AtAccessor</span><span class="p">:</span>
        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Initialize the AtAccessor.</span>

<span class="sd">            :param data: The custom DataFrame object to which this accessor is attached.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span> <span class="o">=</span> <span class="n">data</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Retrieve a single element from the CustomDataFrame using label-based indexing.</span>

<span class="sd">            This method provides access to a single element, similar to pandas&#39; .at accessor.</span>
<span class="sd">            It expects a single label for both row and column.</span>

<span class="sd">            :param key: A tuple containing the row and column label.</span>
<span class="sd">            :return: The element at the specified row and column location.</span>
<span class="sd">            :raises KeyError: If the specified key is not a tuple or if it does not correspond to a valid row and column label.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Key must be a tuple of (row_label, col_label)&quot;</span><span class="p">)</span>

            <span class="n">row_label</span><span class="p">,</span> <span class="n">col_label</span> <span class="o">=</span> <span class="n">key</span>

            <span class="k">if</span> <span class="n">col_label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="c1"># Check for &#39;parameters&#39; type columns</span>
                <span class="n">typ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">coltype</span><span class="p">(</span><span class="n">col_label</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> 
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col_label</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is of type </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col_label</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is of type </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">. Returning global value.&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">col_label</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Is row already present in relevant _d</span>
                    <span class="k">if</span> <span class="n">row_label</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">row_label</span><span class="p">,</span> <span class="n">col_label</span><span class="p">]</span>
                    <span class="c1"># Is row present in overall dataframe, but not in a mutable _d.                    </span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">row_label</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> not found in column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col_label</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> returning </span><span class="se">\&quot;</span><span class="s2">None</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>

            <span class="k">else</span><span class="p">:</span>        
                <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Key column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col_label</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> not found in the CustomDataFrame&quot;</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Set a single element in the CustomDataFrame using label-based indexing.</span>

<span class="sd">            This method provides a way to set the value of a single element, similar to pandas&#39; .at accessor.</span>
<span class="sd">            It expects a single label for both row and column and updates the value at that location.</span>

<span class="sd">            :param key: A tuple containing the row and column label.</span>
<span class="sd">            :param value: The new value to set at the specified location.</span>
<span class="sd">            :raises KeyError: If the specified key is not a tuple or if it does not correspond</span>
<span class="sd">                              to a valid row and column label.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Key must be a tuple of (row_label, col_label)&quot;</span><span class="p">)</span>

            <span class="n">row_label</span><span class="p">,</span> <span class="n">col_label</span> <span class="o">=</span> <span class="n">key</span>

            <span class="c1"># Check for immutable &#39;input&#39; type columns</span>
            <span class="n">immutable_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">get_input_columns</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">col_label</span> <span class="ow">in</span> <span class="n">immutable_columns</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col_label</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is immutable and cannot be modified.&quot;</span>
                <span class="p">)</span>

            <span class="c1"># Setting the value</span>
            <span class="n">data_modified</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">row_label</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="ow">and</span> <span class="n">col_label</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">row_label</span><span class="p">,</span> <span class="n">col_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="n">data_modified</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="n">row_label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="ow">and</span> <span class="n">typ</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                    <span class="c1"># Add row indexed by row_label to pd.DataFrame data</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">row_label</span><span class="p">,</span> <span class="n">col_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="n">data_modified</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
                <span class="k">elif</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">col_label</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Cannot modify individual elements in &#39;parameters&#39; type data.&quot;</span>
                        <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">data_modified</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Key </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> not found in the CustomDataFrame&quot;</span><span class="p">)</span>

            <span class="c1"># Update the data object with the modified data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">_LocAccessor</span><span class="p">(</span><span class="n">Accessor</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Initialize the LocAccessor.</span>

<span class="sd">            :param data: The custom DataFrame object to which this accessor is attached.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span> <span class="o">=</span> <span class="n">data</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Retrieve a subset of the CustomDataFrame based on the provided key.</span>

<span class="sd">            This method supports both row and column indexing, similar to pandas&#39; .loc accessor.</span>
<span class="sd">            It handles &#39;parameters&#39; data differently from regular data.</span>

<span class="sd">            :param key: The indexing key, which can be a scalar, slice, list, tuple, or pd.Index.</span>
<span class="sd">                        It can be a tuple (row_key, col_key) for row and column indexing.</span>
<span class="sd">            :return: A subset of the CustomDataFrame as specified by the key.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># Determine row_key and col_key based on whether key is a tuple</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">row_key</span><span class="p">,</span> <span class="n">col_key</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_key</span> <span class="o">=</span> <span class="n">key</span>
                <span class="n">col_key</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># Equivalent to selecting all columns</span>

            <span class="n">colspecs</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># check if index is a datetime index.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
                <span class="c1"># if so, allow pandas to handle the slicing.</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_key</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
                <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;object&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row_key</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">)):</span>
                <span class="c1"># if not, check if the row_key is a list of indices.</span>
                <span class="c1"># if so, create a new dataframe with the index of the row_key.</span>
                <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">row_key</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;object&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># create a data series to handle the result with index.name given by row</span>
                <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">row_key</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;object&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># Check if col_key is a scalar and convert to list if necessary</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_key</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">slice</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">)):</span>
                    <span class="n">col_key</span> <span class="o">=</span> <span class="p">[</span><span class="n">col_key</span><span class="p">]</span>

                <span class="c1"># Handle &quot;parameters&quot; data</span>
                <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                    <span class="n">selected_cols</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">col_key</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_key</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">))</span>
                        <span class="k">else</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">selected_cols</span><span class="p">:</span>
                        <span class="n">result_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                    
                    <span class="n">colspecs</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_cols</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Handle regular data</span>
                    <span class="n">filtered_cols</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">col_key</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_key</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">))</span>
                        <span class="k">else</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span>
                    <span class="p">)</span>
                    <span class="n">selected_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_key</span><span class="p">,</span> <span class="n">filtered_cols</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selected_data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The selected data has a row key </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">row_key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> that has induced a series, but the result_df is of type </span><span class="se">\&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="c1"># Concatenate the two data series</span>
                        <span class="k">if</span> <span class="n">result_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                            <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">selected_data</span><span class="p">])</span>
                        <span class="k">elif</span> <span class="ow">not</span> <span class="n">selected_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                            <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">result_df</span><span class="p">,</span> <span class="n">selected_data</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">result_df</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selected_data</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
                    <span class="n">colspecs</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_cols</span>

            <span class="c1"># Find empty colspecs</span>
            <span class="n">del_types</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="n">colspecs</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colspecs</span><span class="p">[</span><span class="n">typ</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">del_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">typ</span><span class="p">)</span>

            <span class="c1"># Delete empty colspecs</span>
            <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="n">del_types</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">colspecs</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">colspecs</span><span class="o">=</span><span class="n">colspecs</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Set values in the CustomDataFrame based on the provided key.</span>

<span class="sd">            This method supports both row and column indexing. It raises an error if attempting</span>
<span class="sd">            to modify immutable &#39;input&#39; type columns.</span>

<span class="sd">            :param key: The indexing key, similar to pandas .loc accessor.</span>
<span class="sd">            :param value: The value to set at the specified key location.</span>
<span class="sd">            :raises KeyError: If attempting to modify immutable &#39;input&#39; type columns.</span>
<span class="sd">            :raises ValueError: If provided values for &#39;parameters&#39; type data are not identical.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># Determine row_key and col_key based on whether key is a tuple</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">row_key</span><span class="p">,</span> <span class="n">col_key</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_key</span> <span class="o">=</span> <span class="n">key</span>
                <span class="n">col_key</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># Equivalent to selecting all columns</span>

            <span class="c1"># Extract the list of immutable columns from colspecs based on types[&quot;input&quot;]</span>
            <span class="n">immutable_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">get_input_columns</span><span class="p">()</span>

            <span class="c1"># Check if any of the columns being modified are immutable</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_key</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">)):</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">col</span> <span class="ow">in</span> <span class="n">immutable_columns</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">col_key</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Attempted to modify one or more immutable &#39;input&#39; type columns when you tried to modify columns </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col_key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">col_key</span> <span class="ow">in</span> <span class="n">immutable_columns</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Attempted to modify an immutable &#39;input&#39; type column when you tried to modify column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">col_key</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

            <span class="c1"># Setting values</span>
            <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># Check if col_key is a scalar and convert to list if necessary</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_key</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">slice</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">)):</span>
                    <span class="n">col_key</span> <span class="o">=</span> <span class="p">[</span><span class="n">col_key</span><span class="p">]</span>

                <span class="c1"># Select the relevant columns</span>
                <span class="n">rel_col</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">col_key</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">colspecs</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rel_col</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                    <span class="c1"># Ensure that provided values for &#39;parameters&#39; are identical across all rows</span>
                    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">rel_col</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
                            <span class="n">value</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                        <span class="p">):</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                <span class="s2">&quot;Non-identical values provided for &#39;parameters&#39; type data&quot;</span>
                            <span class="p">)</span>
                        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">):</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                <span class="s2">&quot;Non-identical values provided for &#39;parameters&#39; type data&quot;</span>
                            <span class="p">)</span>

                        <span class="c1"># Setting values for &#39;parameters&#39; type data</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">value</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
                            <span class="k">else</span> <span class="n">value</span>
                        <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Handle setting values for regular data</span>
                    <span class="n">selected_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">col_key</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_key</span><span class="p">,</span> <span class="n">selected_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

                <span class="c1"># Update the data object with the modified data</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">_ILocAccessor</span><span class="p">(</span><span class="n">Accessor</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Initialize the ILocAccessor.</span>

<span class="sd">            :param data: The custom DataFrame object to which this accessor is attached.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span> <span class="o">=</span> <span class="n">data</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Retrieve a subset of the CustomDataFrame based on integer-location based indexing.</span>

<span class="sd">            This method provides integer-location based indexing, similar to pandas&#39; .iloc accessor.</span>
<span class="sd">            It internally converts integer indices to labels and then uses the .loc accessor.</span>

<span class="sd">            :param key: The indexing key, which can be an integer, slice, list, or tuple for</span>
<span class="sd">                        both rows and columns.</span>
<span class="sd">            :return: A subset of the CustomDataFrame as specified by the integer-location key.</span>
<span class="sd">            :raises IndexError: If the specified key is not a tuple or if it does not correspond</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># Convert integer indices to labels for rows and columns</span>
            <span class="n">row_labels</span><span class="p">,</span> <span class="n">col_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ikey_to_labels</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

            <span class="c1"># Use .loc accessor with label-based keys</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_labels</span><span class="p">,</span> <span class="n">col_labels</span><span class="p">]</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Set values in the CustomDataFrame based on integer-location based indexing.</span>

<span class="sd">            This method provides integer-location based indexing, similar to pandas&#39; .iloc accessor.</span>

<span class="sd">            :param key: The indexing key, which can be an integer, slice, list, or tuple for</span>
<span class="sd">                        both rows and columns.</span>
<span class="sd">            :param value: The value to set at the specified key location.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># Convert integer indices to labels for rows and columns</span>
            <span class="n">row_labels</span><span class="p">,</span> <span class="n">col_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ikey_to_labels</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_labels</span><span class="p">,</span> <span class="n">col_labels</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_ikey_to_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Convert integer-location indices to label-based indices.</span>

<span class="sd">            :param key: The integer-location based index or slice.</span>
<span class="sd">            :return: Label-based indices corresponding to the integer-location key.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">row_key</span><span class="p">,</span> <span class="n">col_key</span> <span class="o">=</span> <span class="n">key</span>
                <span class="n">row_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_to_labels</span><span class="p">(</span><span class="n">row_key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="n">col_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_to_labels</span><span class="p">(</span><span class="n">col_key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_to_labels</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_object</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="n">col_labels</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># Select all columns</span>

            <span class="k">return</span> <span class="n">row_labels</span><span class="p">,</span> <span class="n">col_labels</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_convert_to_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Convert integer-location indices to label-based indices.</span>

<span class="sd">            :param key: The integer-location based index or slice.</span>
<span class="sd">            :param labels: The index or columns of the DataFrame from which to extract labels.</span>
<span class="sd">            :return: Label-based indices corresponding to the integer-location key.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
                <span class="c1"># Convert slice of integer indices to labels</span>
                <span class="k">return</span> <span class="n">labels</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
                <span class="c1"># Convert list or single integer index to labels</span>
                <span class="k">return</span> <span class="n">labels</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Invalid index type for iloc indexing&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_distribute_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal method to distribute data into the _d dictionary based on column specifications.</span>
<span class="sd">        </span>
<span class="sd">        :param data: The input data to distribute.</span>
<span class="sd">        :type data: pandas.DataFrame or list of pandas.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
     
        <span class="c1"># Make a list out of it</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data must be a pandas DataFrame or a custom data frame.&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">cols</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="c1"># Check if the column is all NaN/None and the value is NaN.</span>
                        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                <span class="sa">f</span><span class="s1">&#39;Column &quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&quot; is specified as a parameter column and yet the values of the column are not all the same.&#39;</span>
                            <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Fix for NumPy compatibility issue - use loc instead of direct indexing</span>
                    <span class="c1"># which uses take internally and has issues with _NoValueType</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Only try to access if there are columns to retrieve</span>
                        <span class="n">d</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">cols</span><span class="p">]</span>  <span class="c1"># Use .loc instead of df[cols]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Create an empty DataFrame with the same index as df</span>
                        <span class="n">d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                        
                    <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;series&quot;</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># If it&#39;s not a series type make sure it&#39;s deduplicated.</span>
                        <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">has_duplicates</span><span class="p">:</span>
                            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing duplicated elements from </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> loaded data.&quot;</span><span class="p">)</span>
                            <span class="c1"># Find the duplicated indices</span>
                            <span class="n">duplicated_indices</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
                            <span class="c1"># Check for each duplicated index all elements are equal</span>
                            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">duplicated_indices</span><span class="p">:</span>
                                <span class="n">duplicates</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="n">duplicates</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">duplicates</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Duplicated index </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> has different values in columns that are specified as </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> which is not a </span><span class="se">\&quot;</span><span class="s2">series</span><span class="se">\&quot;</span><span class="s2"> type.&quot;</span><span class="p">)</span>
                            
                            <span class="c1"># Remove the duplicated indices</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="o">~</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>

<div class="viewcode-block" id="CustomDataFrame.to_pandas">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.to_pandas">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the CustomDataFrame to a pandas DataFrame.</span>

<span class="sd">        :return: A pandas DataFrame representation of the CustomDataFrame.</span>
<span class="sd">        :rtype: pandas.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">df1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ind</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">df1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">df1</span> <span class="o">=</span> <span class="n">data</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df1</span></div>


<div class="viewcode-block" id="CustomDataFrame.update_from_pandas">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.update_from_pandas">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_from_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">colspecs</span> <span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert from a pandas data frame to a CustomDataFrame.</span>

<span class="sd">        :param df: A pandas DataFrame to update an existing data frame with.</span>
<span class="sd">        :param colspecs: The column specifications to use.</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">colspecs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_colspecs</span> <span class="o">=</span> <span class="n">colspecs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_distribute_data</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></div>



<div class="viewcode-block" id="CustomDataFrame.filter">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.filter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_from_pandas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span> <span class="p">:</span> <span class="n">Interface</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Compute</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract the compute object.</span>

<span class="sd">        :param interface: The interface to the compute object.</span>
<span class="sd">        :type interface: lynguine.config.interface.Interface or dict</span>
<span class="sd">        :returns: The compute object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Compute</span><span class="o">.</span><span class="n">from_flow</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span><span class="o">.</span><span class="n">computes</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_finalize_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span> <span class="p">:</span> <span class="s2">&quot;CustomDataFrame&quot;</span><span class="p">,</span> <span class="n">interface</span> <span class="p">:</span> <span class="n">Interface</span><span class="p">,</span> <span class="n">strict_columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;CustomDataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function augments the raw data and sets the index of the data frame.</span>
<span class="sd">        :param df: The data frame to be augmented.</span>
<span class="sd">        :param interface: The details of the data frame.</span>
<span class="sd">        :param strict_columns: Whether to enforce strict columns.</span>
<span class="sd">        :return: The augmented data frame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_finalize_ds</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">interface</span><span class="p">,</span> <span class="n">strict_columns</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;mapping&quot;</span> <span class="ow">in</span> <span class="n">interface</span><span class="p">:</span>            
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">interface</span><span class="p">[</span><span class="s2">&quot;mapping&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_name_column_map</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># Add column names to the column name map.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_augment_column_names</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;index&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">interface</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Missing index field in data frame specification in interface file&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interface</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&quot;index&quot; should be a string in interface.&#39;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

        <span class="n">index_column_name</span> <span class="o">=</span> <span class="n">interface</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="s2">&quot;columns&quot;</span> <span class="ow">in</span> <span class="n">interface</span><span class="p">:</span>
            <span class="c1"># Make sure the listed columns are present.</span>
            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">interface</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">strict_columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;columns&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">interface</span><span class="p">:</span>
                    <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;You can&#39;t have strict_columns set to True and not list the columns in the interface structure.&quot;</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                
                <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">interface</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">column</span><span class="o">!=</span><span class="n">index_column_name</span><span class="p">:</span>
                        <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;DataFrame contains column: </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> which is not in the columns list of the specification and strict_columns is set to </span><span class="se">\&quot;</span><span class="s2">True</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

        <span class="c1"># Set the index column</span>
        <span class="k">if</span> <span class="n">index_column_name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">index_column_name</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">index_column_name</span><span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="n">index_column_name</span><span class="p">]</span>            
                    
        <span class="k">return</span> <span class="n">df</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_finalize_ds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">interface</span> <span class="p">:</span> <span class="n">Interface</span><span class="p">,</span> <span class="n">strict_columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;CustomDataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function augments the raw data and sets the index of the data frame.</span>
<span class="sd">        :param ds: The data series to be augmented.</span>
<span class="sd">        :param interface: The details of the data frame.</span>
<span class="sd">        :param strict_columns: Whether to enforce strict columns.</span>
<span class="sd">        :return: The augmented data frame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Not implemented&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ds</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_augment_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add each column name to the column name map if not already there.</span>

<span class="sd">        :param data: data whose columns (or index if its a series) need to be added to the map.</span>
<span class="sd">        :type data: pd.DataFrame or pd.Series</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span> <span class="c1"># if data is a series, likely its a parameter and its index is equivalent to columns</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="c1"># If column title is valid variable name, add it to the column name map</span>
            <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_name_map</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">is_valid_var</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_name_column_map</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">to_camel_case</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

                    <span class="c1"># If the name is a keyword, append &quot;Field&quot; to it</span>
                    <span class="k">if</span> <span class="n">iskeyword</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="n">column</span> <span class="o">+</span> <span class="s2">&quot;Field&quot;</span>
                        
                    <span class="c1"># Keep variable names as private</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;_&quot;</span><span class="p">:</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">name</span>

                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is not a valid variable name and there is no mapping entry to provide an alternative. Auto-generating a mapping entry </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> to provide a valid variable name to use as proxy for </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">is_valid_var</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_name_column_map</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> is not a valid variable name. Tried autogenerating a camel case name </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> but it is also not valid. Please add a mapping entry to provide an alternative to use as proxy for </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
    
    
<div class="viewcode-block" id="CustomDataFrame.update_name_column_map">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.update_name_column_map">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_name_column_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">column</span> <span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the map from valid variable names to columns in the data frame. Valid variable names are needed e.g. for Liquid filters.</span>

<span class="sd">        :param name: The name of the variable.</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param column: The column in the data frame.</span>
<span class="sd">        :type column: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_name_map</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_name_map</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">!=</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">original_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_name_map</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> already exists in the name-column map and there&#39;s an attempt to update its value to </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> when it&#39;s original value was </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">original_name</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> and that would lead to unexpected behaviours. Try looking to see if you&#39;re setting column values to different names across different files and/or file loaders.&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name_column_map</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_column_name_map</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span></div>

        
    <span class="k">def</span><span class="w"> </span><span class="nf">_default_mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate the default mapping from config or from columns</span>

<span class="sd">        :returns: dictionary of mapping between variable names and column values</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name_column_map</span>

<div class="viewcode-block" id="CustomDataFrame.mapping">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.mapping">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate dictionary of mapping between variable names and column values.</span>

<span class="sd">        :param mapping: mapping to use, if None use default mapping</span>
<span class="sd">        :param series: series to use, if None use current series</span>
<span class="sd">        :returns: dictionary of mapping between variable names and column values</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">mapping</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating new mapping as mapping is None.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">series</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># remove any columns not in self.columns</span>
                <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">column</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_mapping</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="ow">or</span> <span class="n">column</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mapping is </span><span class="se">\&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># remove any columns not in provided series</span>
                <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">column</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_mapping</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="p">}</span>

        <span class="n">form</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">series</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="ow">or</span> <span class="n">column</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting column to </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> to extract mapping.&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
                    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
                    
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> column of format to </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
                    <span class="n">form</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                    
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Column </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> in mapping is not in columns </span><span class="se">\&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">series</span><span class="p">:</span>
                    <span class="n">form</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">series</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
        <span class="n">mapping</span> <span class="o">=</span> <span class="n">remove_nan</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>        
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mapping now has the following keys </span><span class="se">\&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>        
        <span class="k">return</span> <span class="n">remove_nan</span><span class="p">(</span><span class="n">form</span><span class="p">)</span></div>


<div class="viewcode-block" id="CustomDataFrame.viewer_to_value">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.viewer_to_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">viewer_to_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">viewer</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a viewer structure to populated values.</span>

<span class="sd">        :param viewer: The viewer to create the text of.</span>
<span class="sd">        :type viewer: dict or list of dicts</span>
<span class="sd">        :param kwargs: The mapping to use to populate the viewer.</span>
<span class="sd">        :type kwargs: dict</span>
<span class="sd">        :returns: The text of the viewer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">viewer</span> <span class="o">=</span> <span class="p">[</span><span class="n">viewer</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">view</span> <span class="ow">in</span> <span class="n">viewer</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;viewer_to_value: Converting </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">view</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_to_value</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="CustomDataFrame.view_to_value">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.view_to_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">view_to_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the text of the view.</span>

<span class="sd">        :param view: The view to create the text of.</span>
<span class="sd">        :type view: dict</span>
<span class="sd">        :param kwargs: The mapping to use to populate the view.</span>
<span class="sd">        :type kwargs: dict</span>
<span class="sd">        :returns: The text of the view.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Ensure view is a dictionary or an Interface</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Entering view to value&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating mapping as kwargs not present.&quot;</span><span class="p">)</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span><span class="p">()</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;kwargs are now </span><span class="se">\&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">Interface</span><span class="p">):</span>
            <span class="n">view</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;View should be a </span><span class="se">\&quot;</span><span class="s2">dict</span><span class="se">\&quot;</span><span class="s2"> or an </span><span class="se">\&quot;</span><span class="s2">Interface</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="p">(</span><span class="n">view</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;local&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="n">local</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;local&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s2">&quot;list&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">view</span><span class="p">[</span><span class="s2">&quot;list&quot;</span><span class="p">]:</span>
                    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_to_value</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">local</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">values</span>
            <span class="k">if</span> <span class="s2">&quot;field&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value_column</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s2">&quot;join&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;list&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">view</span><span class="p">[</span><span class="s2">&quot;join&quot;</span><span class="p">]:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No field </span><span class="se">\&quot;</span><span class="s2">list</span><span class="se">\&quot;</span><span class="s2"> in </span><span class="se">\&quot;</span><span class="s2">concat</span><span class="se">\&quot;</span><span class="s2"> viewer.&quot;</span><span class="p">)</span>
                <span class="n">elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_to_value</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;join&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">local</span><span class="p">)</span>
                <span class="k">if</span> <span class="s2">&quot;separator&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">[</span><span class="s2">&quot;join&quot;</span><span class="p">]:</span>
                    <span class="n">sep</span> <span class="o">=</span> <span class="n">view</span><span class="p">[</span><span class="s2">&quot;join&quot;</span><span class="p">][</span><span class="s2">&quot;separator&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;compute&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_to_value</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;compute&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s2">&quot;liquid&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_to_value</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;liquid&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">local</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;tally&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="c1"># Don&#39;t pass kwargs to tally_to_view as they need to be refreshed for subseries elements.</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tally_to_value</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;tally&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="n">local</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;display&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_to_value</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;display&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">local</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;View needs to contain a key which is one of </span><span class="se">\&quot;</span><span class="s2">list</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">field</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">join</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">compute</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">liquid</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">tally</span><span class="se">\&quot;</span><span class="s2">, or </span><span class="se">\&quot;</span><span class="s2">display</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="CustomDataFrame.summary_viewer_to_value">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.summary_viewer_to_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">summary_viewer_to_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">viewer</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a summary viewer structure to populated values.</span>

<span class="sd">        :param viewer: The summary viewer to create the text of.</span>
<span class="sd">        :type viewer: dict or list of dicts</span>
<span class="sd">        :param kwargs: The mapping to use to populate the summary viewer.</span>
<span class="sd">        :type kwargs: dict</span>
<span class="sd">        :returns: The text of the summary viewer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">viewer</span> <span class="o">=</span> <span class="p">[</span><span class="n">viewer</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">view</span> <span class="ow">in</span> <span class="n">viewer</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_view_to_value</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">value</span></div>

    
<div class="viewcode-block" id="CustomDataFrame.summary_view_to_value">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.summary_view_to_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">summary_view_to_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the text of the summary view.</span>

<span class="sd">        :param view: The summary view to create the text of.</span>
<span class="sd">        :type view: dict</span>
<span class="sd">        :param kwargs: The mapping to use to populate the summary view.</span>
<span class="sd">        :type kwargs: dict</span>
<span class="sd">        :returns: The text of the summary view.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Ensure view is a dictionary or an Interface</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">Interface</span><span class="p">):</span>
            <span class="n">view</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;View should be a </span><span class="se">\&quot;</span><span class="s2">dict</span><span class="se">\&quot;</span><span class="s2"> or an </span><span class="se">\&quot;</span><span class="s2">Interface</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="p">(</span><span class="n">view</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;list&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">view</span><span class="p">[</span><span class="s2">&quot;list&quot;</span><span class="p">]:</span>
                    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_to_value</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">local</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">values</span>
            <span class="k">if</span> <span class="s2">&quot;join&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;list&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">view</span><span class="p">[</span><span class="s2">&quot;join&quot;</span><span class="p">]:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No field </span><span class="se">\&quot;</span><span class="s2">list</span><span class="se">\&quot;</span><span class="s2"> in </span><span class="se">\&quot;</span><span class="s2">concat</span><span class="se">\&quot;</span><span class="s2"> viewer.&quot;</span><span class="p">)</span>
                <span class="n">elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_to_value</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;join&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="s2">&quot;separator&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">[</span><span class="s2">&quot;join&quot;</span><span class="p">]:</span>
                    <span class="n">sep</span> <span class="o">=</span> <span class="n">view</span><span class="p">[</span><span class="s2">&quot;join&quot;</span><span class="p">][</span><span class="s2">&quot;separator&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;field&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value_column</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s2">&quot;compute&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_to_value</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;compute&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">local</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;liquid&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_to_value</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;liquid&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">local</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;tally&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tally_to_value</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;tally&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">local</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;display&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_to_value</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;display&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">local</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="CustomDataFrame.view_to_tmpname">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.view_to_tmpname">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">view_to_tmpname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a view to a name</span>

<span class="sd">        :param view: The view to convert to a name.</span>
<span class="sd">        :type view: dict</span>
<span class="sd">        :returns: A name derived from the view./</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;list&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;list_&quot;</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">view</span><span class="p">[</span><span class="s2">&quot;list&quot;</span><span class="p">]:</span>
                <span class="n">name</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_to_tmpname</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">+=</span> <span class="s2">&quot;_&quot;</span>
            <span class="k">return</span> <span class="n">name</span>
        <span class="k">elif</span> <span class="s2">&quot;field&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">to_camel_case</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s2">&quot;join&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;join_&quot;</span>
            <span class="k">if</span> <span class="s2">&quot;list&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">view</span><span class="p">[</span><span class="s2">&quot;join&quot;</span><span class="p">]:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No field </span><span class="se">\&quot;</span><span class="s2">list</span><span class="se">\&quot;</span><span class="s2"> in </span><span class="se">\&quot;</span><span class="s2">concat</span><span class="se">\&quot;</span><span class="s2"> viewer.&quot;</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_to_tmpname</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;join&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">name</span>
        <span class="k">elif</span> <span class="s2">&quot;compute&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_to_tmpname</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;compute&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s2">&quot;liquid&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_to_tmpname</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;liquid&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s2">&quot;display&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_to_tmpname</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;display&quot;</span><span class="p">])</span></div>


<div class="viewcode-block" id="CustomDataFrame.tally_to_value">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.tally_to_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tally_to_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tally</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the text of the view.</span>

<span class="sd">        :param tally: The tally to create the text of.</span>
<span class="sd">        :type tally: dict</span>
<span class="sd">        :param kwargs: The mapping to use to populate the tally.</span>
<span class="sd">        :type kwargs: dict</span>
<span class="sd">        :returns: The text of the tally.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tally_values</span><span class="p">(</span><span class="n">tally</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">local</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">tally_to_tmpname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tally</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a view to a temporary name</span>

<span class="sd">        :param tally: The tally to convert to a name.</span>
<span class="sd">        :type tally: dict</span>
<span class="sd">        :returns: A name derived from the tally.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;tally&quot;</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tally_to_tmpname</span><span class="p">(</span><span class="n">view</span><span class="p">[</span><span class="s2">&quot;tally&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">name</span>

<div class="viewcode-block" id="CustomDataFrame.conditions">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.conditions">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if a given data viewer should be displayed.</span>

<span class="sd">        :param view: The data viewer to check.</span>
<span class="sd">        :type view: dict or Interface</span>
<span class="sd">        :returns: True if the data viewer should be displayed, False otherwise.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;conditions&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">view</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">condition</span> <span class="ow">in</span> <span class="n">view</span><span class="p">[</span><span class="s2">&quot;conditions&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="s2">&quot;present&quot;</span> <span class="ow">in</span> <span class="n">condition</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">[</span><span class="s2">&quot;present&quot;</span><span class="p">][</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                        <span class="k">return</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">condition</span><span class="p">[</span><span class="s2">&quot;present&quot;</span><span class="p">][</span><span class="s2">&quot;field&quot;</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()):</span>
                            <span class="k">return</span> <span class="kc">False</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">return</span> <span class="kc">True</span>

                <span class="k">if</span> <span class="s2">&quot;equal&quot;</span> <span class="ow">in</span> <span class="n">condition</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">condition</span><span class="p">[</span><span class="s2">&quot;equal&quot;</span><span class="p">][</span><span class="s2">&quot;field&quot;</span><span class="p">])</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="o">==</span> <span class="n">condition</span><span class="p">[</span><span class="s2">&quot;equal&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]:</span>
                        <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="CustomDataFrame.display_to_tmpname">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.display_to_tmpname">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">display_to_tmpname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">display</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a display string to a temp name</span>

<span class="sd">        :param display: The display string to convert.</span>
<span class="sd">        :type display: str</span>
<span class="sd">        :returns: A name derived from the display string.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">to_camel_case</span><span class="p">(</span><span class="n">display</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span></div>



<div class="viewcode-block" id="CustomDataFrame.display_to_value">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.display_to_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">display_to_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a display string to a string.</span>

<span class="sd">        :param display: The display string to convert.</span>
<span class="sd">        :type display: str</span>
<span class="sd">        :param kwargs: The mapping to use for the display string, defaults to None</span>
<span class="sd">        :type kwargs: dict, optional</span>
<span class="sd">        :param local: Local overrides to use on top of the kwargs for substitution in the display string, defaults to {}</span>
<span class="sd">        :type local: dict, optional</span>
<span class="sd">        :returns: The string extracted from the display string.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        :raises KeyError: If the mapping doesn&#39;t contain the key requested in the display string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span><span class="p">()</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">local</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">display</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The mapping doesn&#39;t contain the key </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2"> requested in </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">display</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">. Set the mapping in </span><span class="se">\&quot;</span><span class="s2">_referia.yml</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span></div>


<div class="viewcode-block" id="CustomDataFrame.compute_to_value">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.compute_to_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_to_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compute</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract a value from a computation</span>

<span class="sd">        :param compute: The interface details containing the computation to extract the value from.</span>
<span class="sd">        :type compute: dict or Interface</span>
<span class="sd">        :returns: The value extracted from the computation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compute</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="CustomDataFrame.compute_to_tmpname">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.compute_to_tmpname">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_to_tmpname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compute</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a compute specification to a descriptive name</span>

<span class="sd">        :param compute: The compute specification to convert to a name.</span>
<span class="sd">        :type compute: dict or Interface</span>
<span class="sd">        :returns: A name derived from the compute specification.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">to_camel_case</span><span class="p">(</span><span class="n">compute</span><span class="p">[</span><span class="s2">&quot;function&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span><span class="s2">&quot;-&quot;</span><span class="p">))</span></div>

        
<div class="viewcode-block" id="CustomDataFrame.liquid_to_tmpname">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.liquid_to_tmpname">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">liquid_to_tmpname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">display</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a liquid template specification to a decriptive name.</span>

<span class="sd">        :param display: The liquid template specification to convert to a name.</span>
<span class="sd">        :type display: str</span>
<span class="sd">        :returns: A name derived from the liquid template specification.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">to_camel_case</span><span class="p">(</span><span class="n">display</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span><span class="s2">&quot;-&quot;</span><span class="p">))</span></div>


    
<div class="viewcode-block" id="CustomDataFrame.liquid_to_value">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.liquid_to_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">liquid_to_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a liquid template to a string.</span>

<span class="sd">        :param display: The liquid template to convert.</span>
<span class="sd">        :type display: str</span>
<span class="sd">        :param kwargs: The mapping to use for the liquid template, defaults to None</span>
<span class="sd">        :type kwargs: dict, optional</span>
<span class="sd">        :param local: Local overrides to use on top of the kwargs for substitution in the liquid template, defaults to {}</span>
<span class="sd">        :type local: dict, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling liquid_to_value with display argument </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">display</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Compute needs to be initialised before liquid_to_value is called.&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="o">==</span><span class="p">{}:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span><span class="p">()</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">local</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kwargs is </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">_liquid_env</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">display</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="o">**</span><span class="n">remove_nan</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;In </span><span class="si">{</span><span class="n">display</span><span class="si">}</span><span class="se">\n\n</span><span class="s2"> </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span></div>


<div class="viewcode-block" id="CustomDataFrame.tally_to_tmpname">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.tally_to_tmpname">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tally_to_tmpname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tally</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a tally to a temporary name&quot;&quot;&quot;</span>
        <span class="n">tmpname</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;begin&quot;</span> <span class="ow">in</span> <span class="n">tally</span><span class="p">:</span>
            <span class="n">tmpname</span> <span class="o">+=</span> <span class="s2">&quot;begin_&quot;</span>
            <span class="n">tmpname</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_to_tmpname</span><span class="p">(</span><span class="n">tally</span><span class="p">[</span><span class="s2">&quot;begin&quot;</span><span class="p">])</span>
        <span class="n">tmpname</span> <span class="o">+=</span> <span class="s2">&quot;display_&quot;</span>
        <span class="n">tmpname</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_to_tmpname</span><span class="p">(</span><span class="n">tally</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;end&quot;</span> <span class="ow">in</span> <span class="n">tally</span><span class="p">:</span>
            <span class="n">tmpname</span> <span class="o">+=</span> <span class="s2">&quot;end_&quot;</span>
            <span class="n">tmpname</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_to_tmpname</span><span class="p">(</span><span class="n">tally</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">tmpname</span></div>


<div class="viewcode-block" id="CustomDataFrame.tally_values">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.tally_values">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tally_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tally</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the text of the tally. A tally has a &quot;begin&quot; field, and an &quot;end&quot; field and is used for summarising a series.</span>

<span class="sd">        :param tally: The tally to create the text of.</span>
<span class="sd">        :type tally: dict</span>
<span class="sd">        :param kwargs: The mapping to use to populate the tally.</span>
<span class="sd">        :type kwargs: dict</span>
<span class="sd">        :returns: The text of the tally.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;begin&quot;</span> <span class="ow">in</span> <span class="n">tally</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">+=</span> <span class="n">tally</span><span class="p">[</span><span class="s2">&quot;begin&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="n">orig_subindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subindex</span><span class="p">()</span>
        <span class="n">subindices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tally_series</span><span class="p">(</span><span class="n">tally</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">subindex</span> <span class="ow">in</span> <span class="n">subindices</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_subindex</span><span class="p">(</span><span class="n">subindex</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_to_value</span><span class="p">(</span><span class="n">tally</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">local</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_subindex</span><span class="p">(</span><span class="n">orig_subindex</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;end&quot;</span> <span class="ow">in</span> <span class="n">tally</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">+=</span> <span class="n">tally</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="CustomDataFrame.tally_series">
<a class="viewcode-back" href="../../../modules/assess.html#referia.assess.data.CustomDataFrame.tally_series">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tally_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tally</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the series to be used for a tally.</span>

<span class="sd">        :param tally: The tally to create the text of.</span>
<span class="sd">        :type tally: dict</span>
<span class="sd">        :returns: The series to be used for a tally.</span>
<span class="sd">        :rtype: pd.Series</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">orig_subindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subindex</span><span class="p">()</span>
        <span class="n">subindices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subindices</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">subindices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">subindices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">orig_subindex</span> <span class="ow">in</span> <span class="n">subindices</span><span class="p">:</span>
            <span class="n">cur_loc</span> <span class="o">=</span> <span class="n">subindices</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">orig_subindex</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cur_loc</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">orig_subindex</span> <span class="o">=</span> <span class="n">subindices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">subind_val</span><span class="p">(</span><span class="n">ind</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="n">subindices</span><span class="p">[</span><span class="n">ind</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">subindices</span><span class="o">.</span><span class="n">dtypegg</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requested invalid index in Data.tally_series()&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="n">subindices</span><span class="p">[</span><span class="n">cur_loc</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">subindices</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">subind_series</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">starter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">starter</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">subindices</span><span class="p">[</span><span class="n">ind</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">subindices</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">subindices</span><span class="p">[:</span><span class="n">ind</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">subindices</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requested invalid index in Data.tally_series()&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">starter</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">subindices</span><span class="p">[</span><span class="n">cur_loc</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">subindices</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">subindices</span><span class="p">[:</span><span class="n">cur_loc</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">subindices</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;reverse&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tally</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">tally</span><span class="p">[</span><span class="s2">&quot;reverse&quot;</span><span class="p">]:</span>
            <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span>
            
        <span class="k">if</span> <span class="s2">&quot;which&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tally</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">subindices</span>
        <span class="k">elif</span> <span class="n">tally</span><span class="p">[</span><span class="s2">&quot;which&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;pop&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">subind_val</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tally</span><span class="p">[</span><span class="s2">&quot;which&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">subind_val</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tally</span><span class="p">[</span><span class="s2">&quot;which&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;previous&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">subind_val</span><span class="p">(</span><span class="n">cur_loc</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tally</span><span class="p">[</span><span class="s2">&quot;which&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;next&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">subind_val</span><span class="p">(</span><span class="n">cur_loc</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tally</span><span class="p">[</span><span class="s2">&quot;which&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;earlier&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">subind_series</span><span class="p">(</span><span class="n">cur_loc</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tally</span><span class="p">[</span><span class="s2">&quot;which&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;later&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">subind_series</span><span class="p">(</span><span class="n">cur_loc</span><span class="p">,</span> <span class="n">starter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tally</span><span class="p">[</span><span class="s2">&quot;which&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;others&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">subind_series</span><span class="p">(</span><span class="n">cur_loc</span><span class="p">,</span> <span class="n">starter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subind_series</span><span class="p">(</span><span class="n">cur_loc</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">tally</span><span class="p">[</span><span class="s2">&quot;which&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">subindices</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="s2">&quot;Unrecognised subindices specifier in tally.&quot;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span></div>

    
<span class="k">def</span><span class="w"> </span><span class="nf">concat</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Concatenate a sequence of CustomDataFrame objects into a single CustomDataFrame.</span>

<span class="sd">    :param objs: A sequence of CustomDataFrame objects to concatenate.</span>
<span class="sd">    :param args: Positional arguments to be passed to pandas.concat.</span>
<span class="sd">    :param kwargs: Keyword arguments to be passed to pandas.concat.</span>
<span class="sd">    :return: A new CustomDataFrame representing the concatenation of the input dataframes.</span>
<span class="sd">    :raises ValueError: If objs is empty or contains non-CustomDataFrame objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TK If there are matching indices in the concatenation, need to trigger series in result.</span>
    <span class="c1"># Check for empty or invalid inputs</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">objs</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">CustomDataFrame</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;objs must be a non-empty list of CustomDataFrame objects.&quot;</span><span class="p">)</span>

    <span class="c1"># Concatenate the dataframes</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Check if df has duplicated index.</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">has_duplicates</span><span class="p">:</span>
        <span class="n">colspecs</span> <span class="o">=</span> <span class="s2">&quot;series_cache&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colspecs</span> <span class="o">=</span> <span class="s2">&quot;cache&quot;</span>

    <span class="c1"># Handle types - assuming a consistent approach is defined</span>
    <span class="c1"># This needs to be decided based on how types are to be handled</span>

    <span class="k">return</span> <span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">colspecs</span><span class="o">=</span><span class="n">colspecs</span><span class="p">)</span>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Neil D. Lawrence &lt;email@domain.here&gt;.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>